
======================================================================
 TERMINAL LOGGING STARTED
======================================================================
Log file: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\logs\terminal_log_20251225_103430.txt
Start time: 2025-12-25 10:34:30
======================================================================

[OK] Comprehensive logging enabled: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\logs\comprehensive_log_20251225_103430.log
10:34:30 | INFO     | observability | Observability system initialized
10:34:30 | INFO     | managers.chunk_state_manager | [CHUNK_STATE] Database schema initialized
10:34:30 | INFO     | managers.chunk_state_manager | [CHUNK_STATE] Initialized with db_path=D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\checkpoints\chunk_state.db
10:34:30 | INFO     | managers.checkpoint_manager | [CHECKPOINT] Using SQLite backend (recommended)
10:34:30 | INFO     | managers.checkpoint_manager | CheckpointManager initialized: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\checkpoints (backend: SQLite)
10:34:30 | INFO     | orchestration.queue_worker_system | QueueOrchestrator initialized:
10:34:30 | INFO     | orchestration.queue_worker_system |   Routes: 4
10:34:30 | INFO     | orchestration.queue_worker_system |   Ports: [9222, 9223, 9224, 9225, 9226, 9227, 9232, 9233, 9234]
10:34:30 | INFO     | orchestration.queue_worker_system |   Dates: 11
10:34:30 | INFO     | orchestration.queue_worker_system |   Mode: Custom

============================================================
           CHECKPOINT STATUS
============================================================
  Checkpoint: NOT FOUND (fresh start)
============================================================


======================================================================
               QUEUE-BASED PARALLEL SYSTEM
======================================================================
  Mode: Custom Ranges
  Routes: 4
  Dates: 11
  LF Workers: 9
  OAL: 2 passes, 10 concurrent routes
======================================================================

[STEP 1] Generating chunks...
10:34:30 | INFO     | orchestration.parallel_chunked_system | Generated 3 chunks from 1 custom ranges
10:34:30 | INFO     | orchestration.parallel_chunked_system |   Total tiers: 3
[OK] Generated 3 chunks
  Tier 2: Range 1, Chunk 3/3 (3 days)
  Tier 1: Range 1, Chunk 2/3 (4 days)
  Tier 0: Range 1, Chunk 1/3 (4 days)

[STEP 2] Initializing multiprocessing manager...
[OK] Manager initialized

[STEP 3] Initializing tier queue manager...
10:34:31 | INFO     | orchestration.queue_worker_system | [FIFO] Organized 12 groups for maximum parallelism:

======================================================================
                  EXECUTION PLAN PREVIEW
======================================================================
Verifying: 1. Furthest Dates First  2. Interleaved Routes
----------------------------------------------------------------------
#    | ROUTE      | CHUNK    | DATES (Furthest First)        
----------------------------------------------------------------------
1    | RUH-CAI    | 1        | 2026-01-02 to 2026-01-05      
10:34:31 | INFO     | orchestration.queue_worker_system |   [1] RUH-CAI - Chunk 1 (4 days)
2    | RUH-ATZ    | 1        | 2026-01-02 to 2026-01-05      
10:34:31 | INFO     | orchestration.queue_worker_system |   [2] RUH-ATZ - Chunk 1 (4 days)
3    | CAI-RUH    | 1        | 2026-01-02 to 2026-01-05      
10:34:31 | INFO     | orchestration.queue_worker_system |   [3] CAI-RUH - Chunk 1 (4 days)
4    | ATZ-RUH    | 1        | 2026-01-02 to 2026-01-05      
10:34:31 | INFO     | orchestration.queue_worker_system |   [4] ATZ-RUH - Chunk 1 (4 days)
5    | RUH-CAI    | 2        | 2025-12-29 to 2026-01-01      
10:34:31 | INFO     | orchestration.queue_worker_system |   [5] RUH-CAI - Chunk 2 (4 days)
6    | RUH-ATZ    | 2        | 2025-12-29 to 2026-01-01      
10:34:31 | INFO     | orchestration.queue_worker_system |   [6] RUH-ATZ - Chunk 2 (4 days)
7    | CAI-RUH    | 2        | 2025-12-29 to 2026-01-01      
10:34:31 | INFO     | orchestration.queue_worker_system |   [7] CAI-RUH - Chunk 2 (4 days)
8    | ATZ-RUH    | 2        | 2025-12-29 to 2026-01-01      
10:34:31 | INFO     | orchestration.queue_worker_system |   [8] ATZ-RUH - Chunk 2 (4 days)
9    | RUH-CAI    | 3        | 2025-12-26 to 2025-12-28      
10:34:31 | INFO     | orchestration.queue_worker_system |   [9] RUH-CAI - Chunk 3 (3 days)
10   | RUH-ATZ    | 3        | 2025-12-26 to 2025-12-28      
10:34:31 | INFO     | orchestration.queue_worker_system |   [10] RUH-ATZ - Chunk 3 (3 days)
11   | CAI-RUH    | 3        | 2025-12-26 to 2025-12-28      
10:34:31 | INFO     | orchestration.queue_worker_system |   [11] CAI-RUH - Chunk 3 (3 days)
12   | ATZ-RUH    | 3        | 2025-12-26 to 2025-12-28      
10:34:31 | INFO     | orchestration.queue_worker_system |   [12] ATZ-RUH - Chunk 3 (3 days)
======================================================================

10:34:31 | INFO     | orchestration.queue_worker_system | QueueManager initialized (FIFO MODE):
10:34:31 | INFO     | orchestration.queue_worker_system |   Routes: 4
10:34:31 | INFO     | orchestration.queue_worker_system |   Chunks: 3
10:34:31 | INFO     | orchestration.queue_worker_system |   Total Groups: 12
10:34:31 | INFO     | orchestration.queue_worker_system |   Mode: All groups in single queue (latest dates first)
[OK] Total groups: 12

10:34:31 | INFO     | managers.chunk_state_manager | [CHUNK_STATE] Initialized 12 new tasks
10:34:31 | INFO     | managers.checkpoint_manager | [SQLITE] Initialized 12 tasks in SQLite backend
10:34:31 | INFO     | managers.checkpoint_manager | Run initialized: 20251225_103431 with 12 tasks
[CHECKPOINT] New run initialized (12 tasks)

[STEP 4] Initializing process-safe storage...
10:34:31 | INFO     | core.shared_storage | ProcessSafeStorage initialized
10:34:31 | INFO     | core.shared_storage | [REGISTER] RUH-CAI: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] RUH-ATZ: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] CAI-RUH: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] ATZ-RUH: 11 dates
[OK] Process-safe storage initialized and routes registered

[STEP 5] Starting OAL processor...
10:34:31 | INFO     | orchestration.queue_worker_system | OALProcessor initialized:
10:34:31 | INFO     | orchestration.queue_worker_system |   Routes: 4
10:34:31 | INFO     | orchestration.queue_worker_system |   Dates: 11
10:34:31 | INFO     | orchestration.queue_worker_system |   Passes: 2
10:34:31 | INFO     | orchestration.queue_worker_system | OALProcessor started in background
[OK] OAL processor started (2 passes, 10 concurrent routes)

[STEP 6] Starting result processor...
10:34:31 | INFO     | core.shared_storage | [REGISTER] RUH-CAI: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] RUH-ATZ: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] CAI-RUH: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] ATZ-RUH: 11 dates
10:34:31 | INFO     | orchestration.queue_worker_system | [OAL] Registered 4 routes × 11 dates = 44 total items
10:34:31 | INFO     | orchestration.queue_worker_system |   Mode BY_DIRECTION: 2 groups
10:34:31 | INFO     | orchestration.queue_worker_system |     KSA_TO_EGY: 2 routes
10:34:31 | INFO     | orchestration.queue_worker_system |     EGY_TO_KSA: 2 routes
10:34:31 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Writer initialized (mode=BY_DIRECTION):
10:34:31 | INFO     | orchestration.queue_worker_system |   Routes: 4
10:34:31 | INFO     | orchestration.queue_worker_system |   Tiers: 3
[OK] Result processor started (with incremental file writing)10:34:31 | INFO     | orchestration.queue_worker_system | Result processor started


[STEP 6.5] Starting Excel Writer Thread...
[OK] Excel Writer Thread started (Zero Idle Time Protocol)10:34:31 | INFO     | ExcelWriter | [WRITER] Excel Writer Process started


[STEP 7] Starting workers...
10:34:31 | INFO     | orchestration.queue_worker_system | ============================================================
10:34:31 | INFO     | orchestration.queue_worker_system | FIFO QUEUE MODE - MAXIMUM PARALLELISM
10:34:31 | INFO     | orchestration.queue_worker_system | ============================================================
10:34:31 | INFO     | orchestration.queue_worker_system | [QUEUE] 12 groups loaded into queue
10:34:31 | INFO     | orchestration.queue_worker_system | [QUEUE] 4 routes × 3 chunks = 12 total groups
10:34:31 | INFO     | orchestration.queue_worker_system | [QUEUE] Distribution: Routes interleaved across chunks (latest dates first)
10:34:31 | INFO     | orchestration.queue_worker_system | [QUEUE] All ports will work continuously until queue is empty
10:34:31 | INFO     | orchestration.queue_worker_system | ============================================================
10:34:31 | INFO     | core.shared_storage | [REGISTER] RUH-CAI: 11 dates
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9222 (PID: 39804)
[WORKERS] Launched PowerShell window for port 9222
10:34:31 | INFO     | core.shared_storage | [REGISTER] RUH-ATZ: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] CAI-RUH: 11 dates
10:34:31 | INFO     | core.shared_storage | [REGISTER] ATZ-RUH: 11 dates

[OAL] Starting 2-pass extraction (PARALLEL MODE)
[OAL] Routes: 4 | Dates: 11 | Total requests: 44
[OAL] Concurrency: 10 routes × 4 dates
10:34:31 | INFO     | orchestration.queue_worker_system | [OAL] Starting 2-pass PARALLEL extraction for 4 routes

============================================================
[OAL] PASS 1/2 (PARALLEL)
============================================================
10:34:31 | INFO     | orchestration.queue_worker_system | [OAL] PASS 1/2 (PARALLEL)
[OAL] Pass 1 | Starting route 1/4: RUH-CAI
10:34:31 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: Processing RUH-CAI (11 dates)
10:34:31 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-05
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9223 (PID: 14428)
[WORKERS] Launched PowerShell window for port 9223
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9224 (PID: 44692)
[WORKERS] Launched PowerShell window for port 9224
10:34:31 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-04
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9225 (PID: 68640)
[WORKERS] Launched PowerShell window for port 9225
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9226 (PID: 44728)
[WORKERS] Launched PowerShell window for port 9226
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9227 (PID: 61080)
[WORKERS] Launched PowerShell window for port 9227
10:34:31 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-03
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9232 (PID: 26836)
[WORKERS] Launched PowerShell window for port 9232
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9233 (PID: 77616)
[WORKERS] Launched PowerShell window for port 9233
10:34:31 | INFO     | orchestration.queue_worker_system | [WORKERS] Launched PowerShell window for port 9234 (PID: 20328)
[WORKERS] Launched PowerShell window for port 9234
[OK] 9 workers started10:34:31 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-02
[OAL] Pass 1 | Starting route 2/4: RUH-ATZ
     Ports: [9222, 9223, 9224, 9225, 9226, 9227, 9232, 9233, 9234]

     PowerShell windows: 9 opened10:34:31 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: Processing RUH-ATZ (11 dates)


10:34:31 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-05
10:34:31 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-04
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-03
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-02
[OAL] Pass 1 | Starting route 3/4: CAI-RUH
10:34:32 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: Processing CAI-RUH (11 dates)
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-05
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-04
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-03
[OAL][ASYNC] Fetching fare families for 19 itineraries...
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-02
[OAL] Pass 1 | Starting route 4/4: ATZ-RUH
10:34:32 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: Processing ATZ-RUH (11 dates)
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-05
10:34:32 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-04
10:34:33 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-03
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:34:33 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2026-01-03: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2026-01-03: 0 flight cards
10:34:33 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-01
10:34:33 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-02
[OAL][ASYNC] Fetching fare families for 20 itineraries...
[OAL][ASYNC] Fetching fare families for 21 itineraries...
[OAL][ASYNC] Fetching fare families for 21 itineraries...
======================================================================
                    EXECUTION STARTED
======================================================================

[SESSION PROGRESS] Time: 00:03 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] Fetching fare families for 19 itineraries...
10:34:33 | INFO     | orchestration.queue_worker_system |   Mode BY_DIRECTION: 2 groups
10:34:33 | INFO     | orchestration.queue_worker_system |     KSA_TO_EGY: 2 routes
10:34:33 | INFO     | orchestration.queue_worker_system |     EGY_TO_KSA: 2 routes
10:34:33 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Writer initialized (mode=BY_DIRECTION):
10:34:33 | INFO     | orchestration.queue_worker_system |   Routes: 4
10:34:33 | INFO     | orchestration.queue_worker_system |   Tiers: 1
[EXCHANGE] Fetched live rate from Almosafer: 1 SAR = 12.657013 EGP
[SESSION PROGRESS] Time: 00:05 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] Fetching fare families for 12 itineraries...
[SESSION PROGRESS] Time: 00:07 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4            [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:34:39 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2026-01-04: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2026-01-04: 0 flight cards
10:34:39 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-31
[OAL][ASYNC] Fetching fare families for 7 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:34:39 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2026-01-02: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2026-01-02: 0 flight cards
10:34:39 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-30
[FALLBACK-FARE][OK] Created fallback fare for MS-8245: 14,036 EGP (itinerary: MS5_0_31972-4b56aa5_...)
[FALLBACK-FARE][OK] Created fallback fare for SM-463: 8,619 EGP (itinerary: SM2_0_94783-4b56aa5_...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 6 itineraries, kept 2 (4 filtered)
10:34:39 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2026-01-04: 2 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2026-01-04: 2 flight cards
10:34:39 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-01
[SESSION PROGRESS] Time: 00:09 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
10:34:41 | INFO     | market-insights-queue | worker_started
[SESSION PROGRESS] Time: 00:11 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] Fetching fare families for 7 itineraries...
[FALLBACK-FARE][OK] Created fallback fare for SM-466: 662 SAR (itinerary: SM1_0_52342-ab7c9be0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-8240: 778 SAR (itinerary: MS2_0_49091-ab7c9be0...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 2 (2 filtered)
10:34:43 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-31: 2 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-31: 2 flight cards
10:34:43 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-29
[SESSION PROGRESS] Time: 00:13 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [FALLBACK-FARE][OK] Created fallback fare for MS-8246: 778 SAR (itinerary: MS2_0_14994-f1bb9648...)
[FALLBACK-FARE][OK] Created fallback fare for SM-464: 662 SAR (itinerary: SM1_0_30580-f1bb9648...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 2 (1 filtered)
10:34:44 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-30: 2 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-30: 2 flight cards
10:34:44 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-28
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 416 SAR (itinerary: NP3_0_87068-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 596 SAR (itinerary: MS4_0_66595-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 606 SAR (itinerary: MS5_0_62989-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 714 SAR (itinerary: MS8_0_48236-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for NE-161: 401 SAR (itinerary: NE1_0_41053-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 405 SAR (itinerary: SM2_0_52447-d180fad1...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 127 itineraries, kept 25 (102 filtered)
10:34:45 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-03: 52 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-03: 52 flight cards
10:34:45 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-01
[SESSION PROGRESS] Time: 00:15 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] [OK] Completed fetch: 12 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 416 SAR (itinerary: NP1_0_16802-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 691 SAR (itinerary: MS7_0_25260-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 627 SAR (itinerary: MS4_0_69325-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 627 SAR (itinerary: MS4_1_29009-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 564 SAR (itinerary: SM3_0_18849-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for NP-252: 518 SAR (itinerary: NP2_0_31006-fd62a012...)
  [DEBUG] Extracted 31 unique fare options
[OAL] Filtering stats: found 119 itineraries, kept 18 (101 filtered)
10:34:47 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-05: 31 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-05: 31 flight cards
10:34:47 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-31
[SESSION PROGRESS] Time: 00:17 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [SESSION PROGRESS] Time: 00:19 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] [OK] Completed fetch: 7 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 671 SAR (itinerary: MS3_0_24262-3c2e0e67...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 606 SAR (itinerary: MS2_0_74898-3c2e0e67...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 706 SAR (itinerary: MS6_0_78596-3c2e0e67...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 564 SAR (itinerary: SM1_0_31062-3c2e0e67...)
  [DEBUG] Extracted 15 unique fare options
[OAL] Filtering stats: found 133 itineraries, kept 11 (122 filtered)
10:34:50 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-02: 15 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-02: 15 flight cards
10:34:50 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-30
[OAL][ASYNC] [OK] Completed fetch: 20 results
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 6,037 EGP (itinerary: NP2_0_64113-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 8,201 EGP (itinerary: MS10_0_92573-8aa13e0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 6,986 EGP (itinerary: MS6_0_32854-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 7,543 EGP (itinerary: MS8_0_52563-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 5,796 EGP (itinerary: SM1_0_78966-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for NP-251: 6,037 EGP (itinerary: NP3_0_18013-8aa13e08...)
  [DEBUG] Extracted 54 unique fare options
[OAL] Filtering stats: found 126 itineraries, kept 26 (100 filtered)
10:34:50 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-05: 54 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-05: 54 flight cards
10:34:50 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-01
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 7 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 10,682 EGP (itinerary: MS17_0_51887-33bc975...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 9,568 EGP (itinerary: MS8_0_94480-33bc9758...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 10,581 EGP (itinerary: MS16_0_43558-33bc975...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 8,454 EGP (itinerary: SM7_0_79485-33bc9758...)
  [DEBUG] Extracted 11 unique fare options
[OAL] Filtering stats: found 95 itineraries, kept 11 (84 filtered)
10:34:51 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-02: 11 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-02: 11 flight cards
10:34:51 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-31
[OAL][ASYNC] Fetching fare families for 21 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 518 SAR (itinerary: NP3_0_30992-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 545 SAR (itinerary: MS5_0_23773-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 530 SAR (itinerary: MS4_0_82873-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 627 SAR (itinerary: MS6_0_87880-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 405 SAR (itinerary: SM1_0_28146-5b59763e...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 124 itineraries, kept 26 (98 filtered)
10:34:51 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-04: 55 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-04: 55 flight cards
10:34:51 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-29
[SESSION PROGRESS] Time: 00:21 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 9,075 EGP (itinerary: NP4_0_29416-95834f1d...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 17,757 EGP (itinerary: MS19_0_66579-95834f1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 12,226 EGP (itinerary: MS8_0_15663-95834f1d...)
[FALLBACK-FARE][OK] Created fallback fare for NE-160: 7,923 EGP (itinerary: NE1_0_20807-95834f1d...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 8,454 EGP (itinerary: SM3_0_14786-95834f1d...)
  [DEBUG] Extracted 47 unique fare options
[OAL] Filtering stats: found 98 itineraries, kept 24 (74 filtered)
10:34:52 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-03: 47 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-03: 47 flight cards
10:34:52 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-30
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 9,075 EGP (itinerary: NP9_0_85542-21488c3a...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 8,935 EGP (itinerary: MS8_0_30517-21488c3a...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,100 EGP (itinerary: MS4_0_86852-21488c3a...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS10_0_23892-21488c3...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 7,619 EGP (itinerary: SM3_0_85272-21488c3a...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 113 itineraries, kept 26 (87 filtered)
10:34:52 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-04: 55 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-04: 55 flight cards
10:34:52 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-29
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:34:53 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-28: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-28: 0 flight cards
10:34:53 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-27
[OAL][ASYNC] Fetching fare families for 19 itineraries...
10:34:53 | WARNING  | market_insights.oal.search_async | [OAL][FAILED] RUH-ATZ 2026-01-05: No results from API → Recovery
[OAL][FAILED] RUH-ATZ 2026-01-05: No results → Recovery Queue
10:34:53 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-26
[OAL][ASYNC] Fetching fare families for 1 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:34:53 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete (0 cards) → Recovery Queue
[SESSION PROGRESS] Time: 00:23 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4            [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 0 (5 filtered)
10:34:54 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete (0 cards) → Recovery Queue
10:34:54 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-31
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:34:55 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete (0 cards) → Recovery Queue
10:34:55 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-30
[OAL][ASYNC] Fetching fare families for 20 itineraries...
[SESSION PROGRESS] Time: 00:25 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] Fetching fare families for 21 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 6 itineraries, kept 0 (6 filtered)
10:34:56 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-26: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-26: 0 flight cards
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:34:57 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete (3 cards) → Recovery Queue
10:34:57 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-29
[OAL][ASYNC] Fetching fare families for 7 itineraries...
[SESSION PROGRESS] Time: 00:27 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] Fetching fare families for 1 itineraries...
[FALLBACK-FARE][OK] Created fallback fare for MS-8239: 14,036 EGP (itinerary: MS2_0_92475-c909fe6f...)
[FALLBACK-FARE][OK] Created fallback fare for SM-465: 8,619 EGP (itinerary: SM1_0_33157-c909fe6f...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 2 (1 filtered)
10:34:58 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2025-12-31: 2 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2025-12-31: 2 flight cards
10:34:58 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-28
[OAL][ASYNC] Fetching fare families for 8 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:34:59 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete (0 cards) → Recovery Queue
10:34:59 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-27
[SESSION PROGRESS] Time: 00:29 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4            [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:35:01 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-27: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-27: 0 flight cards
[SESSION PROGRESS] Time: 00:31 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 891 SAR (itinerary: MS10_0_90418-b4cfdf0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 706 SAR (itinerary: MS3_0_17972-b4cfdf01...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 1,006 SAR (itinerary: MS15_0_39891-b4cfdf0...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 405 SAR (itinerary: SM1_0_11875-b4cfdf01...)
[FALLBACK-FARE][OK] Created fallback fare for NP-252: 518 SAR (itinerary: NP2_0_93923-b4cfdf01...)
  [DEBUG] Extracted 51 unique fare options
[OAL] Filtering stats: found 124 itineraries, kept 24 (100 filtered)
10:35:02 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-01: 51 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-01: 51 flight cards
10:35:02 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-28
[OAL][ASYNC] [OK] Completed fetch: 1 results
[FALLBACK-FARE][OK] Created fallback fare for MS-8245: 14,036 EGP (itinerary: MS2_0_97655-62fc593_...)
[FALLBACK-FARE][OK] Created fallback fare for SM-463: 8,619 EGP (itinerary: SM1_0_38364-62fc593_...)
  [DEBUG] Extracted 5 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 3 (1 filtered)
10:35:02 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2025-12-30: 5 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2025-12-30: 5 flight cards
10:35:02 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-26
[FALLBACK-FARE][OK] Created fallback fare for MS-8245: 15,530 EGP (itinerary: MS4_0_87620-1916b65c...)
[FALLBACK-FARE][OK] Created fallback fare for SM-463: 9,416 EGP (itinerary: SM2_0_25590-1916b65c...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 7 itineraries, kept 2 (5 filtered)
10:35:02 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2025-12-28: 2 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2025-12-28: 2 flight cards
[SESSION PROGRESS] Time: 00:33 | LF Workers: 9 active | LF Progress: 0/12 (0.0%) | OAL: Pass 1/2 | Routes: 0/4          10:35:04 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9223 completed RUH-ATZ (Tier 0: Range 1, Chunk 1/3)
10:35:04 | INFO     | market-insights-queue | worker_completed
10:35:04 | INFO     | orchestration.queue_worker_system | [PROGRESS] 1/12 (8.3%) - RUH-ATZ Chunk 1 done
10:35:04 | INFO     | market-insights-queue | worker_started
10:35:05 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9226 completed ATZ-RUH (Tier 0: Range 1, Chunk 1/3)
10:35:05 | INFO     | market-insights-queue | worker_completed
10:35:05 | INFO     | orchestration.queue_worker_system | [PROGRESS] 2/12 (16.7%) - ATZ-RUH Chunk 1 done
10:35:05 | INFO     | market-insights-queue | worker_started
[SESSION PROGRESS] Time: 00:35 | LF Workers: 9 active | LF Progress: 2/12 (16.7%) | OAL: Pass 1/2 | Routes: 0/4          [OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 594 SAR (itinerary: MS5_0_45248-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 445 SAR (itinerary: MS1_0_93176-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 530 SAR (itinerary: MS4_0_23042-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 450 SAR (itinerary: SM2_0_97811-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for NE-161: 500 SAR (itinerary: NE3_0_84151-b83017ff...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 92 itineraries, kept 26 (66 filtered)
10:35:06 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-30: 55 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-30: 55 flight cards
10:35:06 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-27
[OAL][ASYNC] [OK] Completed fetch: 7 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 594 SAR (itinerary: MS7_0_87056-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 437 SAR (itinerary: MS1_0_69770-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 530 SAR (itinerary: MS6_0_24797-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 450 SAR (itinerary: SM3_0_63427-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 450 SAR (itinerary: SM2_0_90990-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for NP-252: 518 SAR (itinerary: NP5_0_82551-18ae80d9...)
  [DEBUG] Extracted 17 unique fare options
[OAL] Filtering stats: found 67 itineraries, kept 13 (54 filtered)
10:35:06 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-31: 17 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-31: 17 flight cards
10:35:06 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-26
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS12_0_79993-84341fc...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 9,568 EGP (itinerary: MS11_1_50745-84341fc...)
[FALLBACK-FARE][OK] Created fallback fare for NE-164: 6,227 EGP (itinerary: NE3_0_19546-84341fcd...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS11_0_60378-84341fc...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 5,796 EGP (itinerary: SM1_0_11231-84341fcd...)
[FALLBACK-FARE][OK] Created fallback fare for NP-251: 6,037 EGP (itinerary: NP2_0_65704-84341fcd...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 111 itineraries, kept 25 (86 filtered)
10:35:07 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-01: 52 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-01: 52 flight cards
10:35:07 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-28
[OAL][ASYNC] Fetching fare families for 21 itineraries...
[SESSION PROGRESS] Time: 00:37 | LF Workers: 9 active | LF Progress: 2/12 (16.7%) | OAL: Pass 1/2 | Routes: 0/4            [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:35:08 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete (0 cards) → Recovery Queue
10:35:08 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-05: [Pass1] FAILED: API returned no data (timeout or blocked)
10:35:08 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-01: [Pass1] PARTIAL: polling incomplete (0 partial cards)
10:35:08 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2025-12-29: [Pass1] PARTIAL: polling incomplete (0 partial cards)
[OAL] RUH-ATZ: 2/11 dates OK, 3 errors
10:35:08 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: RUH-ATZ - 2 OK, 3 errors
10:35:08 | INFO     | orchestration.queue_worker_system | [OAL] RUH-ATZ: Starting alternatives (protected from early exit)
10:35:08 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Reusing RUH-CAI results for RUH-ATZ alternatives (not fetching again)
10:35:08 | INFO     | orchestration.queue_worker_system | [OAL] RUH-ATZ: Completed alternatives processing
[OAL][ASYNC] [OK] Completed fetch: 8 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 358 SAR (itinerary: MS1_0_34924-2a0effe2...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 437 SAR (itinerary: MS3_0_32408-2a0effe2...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 397 SAR (itinerary: SM2_0_94608-2a0effe2...)
  [DEBUG] Extracted 16 unique fare options
[OAL] Filtering stats: found 87 itineraries, kept 11 (76 filtered)
10:35:08 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-29: 16 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-29: 16 flight cards
10:35:08 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9234 completed ATZ-RUH (Tier 0: Range 1, Chunk 2/3)
10:35:08 | INFO     | market-insights-queue | worker_completed
10:35:08 | INFO     | orchestration.queue_worker_system | [PROGRESS] 3/12 (25.0%) - ATZ-RUH Chunk 2 done
10:35:08 | INFO     | market-insights-queue | worker_started
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS12_0_15978-7c2bd19...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,834 EGP (itinerary: MS11_0_96474-7c2bd19...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 8,100 EGP (itinerary: MS9_0_74386-7c2bd194...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 5,796 EGP (itinerary: SM2_0_88264-7c2bd194...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 6,353 EGP (itinerary: SM4_0_94095-7c2bd194...)
[FALLBACK-FARE][OK] Created fallback fare for NP-251: 6,037 EGP (itinerary: NP3_0_64202-7c2bd194...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 118 itineraries, kept 25 (93 filtered)
10:35:08 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-31: 52 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-31: 52 flight cards
10:35:08 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-27
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[SESSION PROGRESS] Time: 00:39 | LF Workers: 9 active | LF Progress: 3/12 (25.0%) | OAL: Pass 1/2 | Routes: 1/4          [OAL][ASYNC] Fetching fare families for 21 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 20 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS7_0_18509-d8258ce3...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,201 EGP (itinerary: MS5_0_33041-d8258ce3...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 6,353 EGP (itinerary: SM1_0_75532-d8258ce3...)
  [DEBUG] Extracted 51 unique fare options
[OAL] Filtering stats: found 124 itineraries, kept 23 (101 filtered)
10:35:11 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-29: 51 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-29: 51 flight cards
10:35:11 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-26
[SESSION PROGRESS] Time: 00:41 | LF Workers: 9 active | LF Progress: 3/12 (25.0%) | OAL: Pass 1/2 | Routes: 1/4          [OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS8_0_51733-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,100 EGP (itinerary: MS4_0_89971-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS7_0_76644-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for NE-160: 5,607 EGP (itinerary: NE1_0_74272-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 6,353 EGP (itinerary: SM2_0_46741-9270d5a0...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 114 itineraries, kept 26 (88 filtered)
10:35:12 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-30: 55 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-30: 55 flight cards
[SESSION PROGRESS] Time: 00:43 | LF Workers: 9 active | LF Progress: 3/12 (25.0%) | OAL: Pass 1/2 | Routes: 1/4          10:35:14 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9227 completed RUH-ATZ (Tier 0: Range 1, Chunk 2/3)
10:35:14 | INFO     | market-insights-queue | worker_completed
10:35:14 | INFO     | orchestration.queue_worker_system | [PROGRESS] 4/12 (33.3%) - RUH-ATZ Chunk 2 done
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[SESSION PROGRESS] Time: 00:45 | LF Workers: 9 active | LF Progress: 4/12 (33.3%) | OAL: Pass 1/2 | Routes: 1/4          [SESSION PROGRESS] Time: 00:47 | LF Workers: 9 active | LF Progress: 4/12 (33.3%) | OAL: Pass 1/2 | Routes: 1/4          [OAL][ASYNC] Fetching fare families for 1 itineraries...
10:35:19 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9223 completed RUH-ATZ (Tier 0: Range 1, Chunk 3/3)
10:35:19 | INFO     | market-insights-queue | worker_completed
10:35:19 | INFO     | orchestration.queue_worker_system | [PROGRESS] 5/12 (41.7%) - RUH-ATZ Chunk 3 done
[SESSION PROGRESS] Time: 00:49 | LF Workers: 9 active | LF Progress: 5/12 (41.7%) | OAL: Pass 1/2 | Routes: 1/4            [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:35:20 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete (0 cards) → Recovery Queue
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 357 SAR (itinerary: NP2_0_38921-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 358 SAR (itinerary: MS3_0_39603-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 350 SAR (itinerary: MS1_0_22517-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 437 SAR (itinerary: MS5_0_16981-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 397 SAR (itinerary: SM4_0_42211-b2e56f0c...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 109 itineraries, kept 26 (83 filtered)
10:35:20 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-28: 55 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-28: 55 flight cards
10:35:20 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9232 completed CAI-RUH (Tier 0: Range 1, Chunk 1/3)
10:35:20 | INFO     | market-insights-queue | worker_completed
10:35:20 | INFO     | orchestration.queue_worker_system | [PROGRESS] 6/12 (50.0%) - CAI-RUH Chunk 1 done
10:35:21 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9224 completed RUH-CAI (Tier 0: Range 1, Chunk 1/3)
10:35:21 | INFO     | market-insights-queue | worker_completed
10:35:21 | INFO     | orchestration.queue_worker_system | [PROGRESS] 7/12 (58.3%) - RUH-CAI Chunk 1 done
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 357 SAR (itinerary: NP2_0_50513-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 358 SAR (itinerary: MS3_0_91307-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 437 SAR (itinerary: MS5_0_43910-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 445 SAR (itinerary: MS6_0_87146-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for NE-161: 350 SAR (itinerary: NE1_0_27107-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 397 SAR (itinerary: SM4_0_19612-fc00bd58...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 121 itineraries, kept 25 (96 filtered)
10:35:21 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-27: 52 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-27: 52 flight cards
10:35:21 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9234 completed ATZ-RUH (Tier 0: Range 1, Chunk 3/3)
10:35:21 | INFO     | market-insights-queue | worker_completed
10:35:21 | INFO     | orchestration.queue_worker_system | [PROGRESS] 8/12 (66.7%) - ATZ-RUH Chunk 3 done
[SESSION PROGRESS] Time: 00:51 | LF Workers: 9 active | LF Progress: 8/12 (66.7%) | OAL: Pass 1/2 | Routes: 1/4          [OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:35:22 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete (3 cards) → Recovery Queue
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 7,277 EGP (itinerary: NP1_0_17078-c711bd6_...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 12,226 EGP (itinerary: MS13_0_58713-c711bd6...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 9,568 EGP (itinerary: MS6_1_22101-c711bd6_...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS6_0_12601-c711bd6_...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 8,454 EGP (itinerary: SM3_0_50722-c711bd6_...)
  [DEBUG] Extracted 54 unique fare options
[OAL] Filtering stats: found 95 itineraries, kept 26 (69 filtered)
10:35:23 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-28: 54 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-28: 54 flight cards
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 12,226 EGP (itinerary: MS6_0_62314-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for NE-160: 6,834 EGP (itinerary: NE2_0_93126-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 6,923 EGP (itinerary: SM3_0_32174-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 6,670 EGP (itinerary: NP1_0_45828-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,834 EGP (itinerary: MS4_0_10053-b4bce099...)
  [DEBUG] Extracted 48 unique fare options
[OAL] Filtering stats: found 90 itineraries, kept 24 (66 filtered)
10:35:23 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-27: 48 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-27: 48 flight cards
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:35:23 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete (0 cards) → Recovery Queue
10:35:23 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-05: [Pass1] PARTIAL: polling incomplete (0 partial cards)
10:35:23 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-02: [Pass1] PARTIAL: polling incomplete (0 partial cards)
10:35:23 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-03: [Pass1] PARTIAL: polling incomplete (3 partial cards)
10:35:23 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-01: [Pass1] PARTIAL: polling incomplete (0 partial cards)
10:35:23 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-29: [Pass1] PARTIAL: polling incomplete (0 partial cards)
10:35:23 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-27: [Pass1] PARTIAL: polling incomplete (3 partial cards)
10:35:23 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-26: [Pass1] PARTIAL: polling incomplete (0 partial cards)
[OAL] ATZ-RUH: 6/11 dates OK, 7 errors
10:35:23 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: ATZ-RUH - 6 OK, 7 errors
10:35:23 | INFO     | orchestration.queue_worker_system | [OAL] ATZ-RUH: Starting alternatives (protected from early exit)
10:35:23 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Reusing CAI-RUH results for ATZ-RUH alternatives (not fetching again)
10:35:23 | INFO     | orchestration.queue_worker_system | [OAL] ATZ-RUH: Completed alternatives processing
[SESSION PROGRESS] Time: 00:53 | LF Workers: 9 active | LF Progress: 8/12 (66.7%) | OAL: Pass 1/2 | Routes: 2/4          [OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 445 SAR (itinerary: MS2_0_11220-8569318e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 606 SAR (itinerary: MS4_0_89141-8569318e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 826 SAR (itinerary: MS10_0_67206-8569318...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 397 SAR (itinerary: SM1_0_20610-8569318e...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 450 SAR (itinerary: SM3_0_61817-8569318e...)
  [DEBUG] Extracted 51 unique fare options
[OAL] Filtering stats: found 110 itineraries, kept 24 (86 filtered)
10:35:24 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-26: 51 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-26: 51 flight cards
[OAL] RUH-CAI: 11/11 dates OK, 0 errors
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: RUH-CAI - 11 OK, 0 errors
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL] RUH-CAI: Completed alternatives processing
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,834 EGP (itinerary: MS4_0_90028-33b282e1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS6_0_55287-33b282e1...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 6,923 EGP (itinerary: SM2_0_56157-33b282e1...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 6,353 EGP (itinerary: SM1_0_29018-33b282e1...)
  [DEBUG] Extracted 47 unique fare options
[OAL] Filtering stats: found 123 itineraries, kept 23 (100 filtered)
10:35:24 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-26: 47 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-26: 47 flight cards
[OAL] CAI-RUH: 11/11 dates OK, 0 errors
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL] Pass 1: CAI-RUH - 11 OK, 0 errors
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL] CAI-RUH: Completed alternatives processing
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Processing 2 reuse mappings
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Copying RUH-CAI → RUH-ATZ
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Successfully reused 450 total cards from RUH-CAI for RUH-ATZ alternatives
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Copying CAI-RUH → ATZ-RUH
10:35:24 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Successfully reused 526 total cards from CAI-RUH for ATZ-RUH alternatives

[OAL] Pass 1 complete: 30 results, 10 errors
[OAL] Waiting 2s before next pass...
[SESSION PROGRESS] Time: 00:55 | LF Workers: 9 active | LF Progress: 8/12 (66.7%) | OAL: Pass 1/2 | Routes: 4/4          
============================================================
[OAL] PASS 2/2 (PARALLEL)
============================================================
10:35:26 | INFO     | orchestration.queue_worker_system | [OAL] PASS 2/2 (PARALLEL)
[OAL] Pass 2 | Starting route 1/4: RUH-CAI
10:35:26 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: Processing RUH-CAI (11 dates)
10:35:26 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-05
10:35:27 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-04
10:35:27 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-03
10:35:27 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-02
[OAL] Pass 2 | Starting route 2/4: RUH-ATZ
10:35:27 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: Processing RUH-ATZ (11 dates)
10:35:27 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-05
10:35:27 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-04
10:35:27 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-03
[SESSION PROGRESS] Time: 00:57 | LF Workers: 9 active | LF Progress: 8/12 (66.7%) | OAL: Pass 2/2 | Routes: 0/4          10:35:27 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-02
[OAL] Pass 2 | Starting route 3/4: CAI-RUH
10:35:28 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: Processing CAI-RUH (11 dates)
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-05
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-04
[OAL][ASYNC] Fetching fare families for 21 itineraries...
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-03
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-02
[FALLBACK-FARE][OK] Created fallback fare for MS-8246: 778 SAR (itinerary: MS2_0_93725-2ff816ca...)
[FALLBACK-FARE][OK] Created fallback fare for SM-464: 596 SAR (itinerary: SM1_0_70346-2ff816ca...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 2 (3 filtered)
10:35:28 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2026-01-04: 2 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2026-01-04: 2 flight cards
[OAL] Pass 2 | Starting route 4/4: ATZ-RUH
10:35:28 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: Processing ATZ-RUH (11 dates)
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-01
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-05
10:35:28 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9222 completed RUH-CAI (Tier 0: Range 1, Chunk 3/3)
10:35:28 | INFO     | market-insights-queue | worker_completed
10:35:28 | INFO     | orchestration.queue_worker_system | [PROGRESS] 9/12 (75.0%) - RUH-CAI Chunk 3 done
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 6 itineraries, kept 0 (6 filtered)
10:35:28 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2026-01-02: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2026-01-02: 0 flight cards
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-04
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-31
10:35:28 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-03
10:35:29 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-02
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:35:29 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2026-01-03: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2026-01-03: 0 flight cards
10:35:29 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-30
[OAL][ASYNC] Fetching fare families for 20 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[FALLBACK-FARE][OK] Created fallback fare for MS-8245: 14,036 EGP (itinerary: MS5_0_31972-4b56aa5_...)
[FALLBACK-FARE][OK] Created fallback fare for SM-463: 8,619 EGP (itinerary: SM2_0_94783-4b56aa5_...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 8 itineraries, kept 2 (6 filtered)
10:35:29 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2026-01-04: 2 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2026-01-04: 2 flight cards
10:35:29 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-01
[SESSION PROGRESS] Time: 00:59 | LF Workers: 9 active | LF Progress: 9/12 (75.0%) | OAL: Pass 2/2 | Routes: 0/4          [OAL][ASYNC] Fetching fare families for 21 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[SESSION PROGRESS] Time: 01:01 | LF Workers: 9 active | LF Progress: 9/12 (75.0%) | OAL: Pass 2/2 | Routes: 0/4          [FALLBACK-FARE][OK] Created fallback fare for SM-466: 662 SAR (itinerary: SM1_0_52342-ab7c9be0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-8240: 778 SAR (itinerary: MS2_0_49091-ab7c9be0...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 2 (2 filtered)
10:35:32 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-31: 2 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-31: 2 flight cards
10:35:32 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-29
10:35:32 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9233 completed RUH-CAI (Tier 0: Range 1, Chunk 2/3)
10:35:32 | INFO     | market-insights-queue | worker_completed
10:35:32 | INFO     | orchestration.queue_worker_system | [PROGRESS] 10/12 (83.3%) - RUH-CAI Chunk 2 done
10:35:33 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9225 completed CAI-RUH (Tier 0: Range 1, Chunk 2/3)
10:35:33 | INFO     | market-insights-queue | worker_completed
10:35:33 | INFO     | orchestration.queue_worker_system | [PROGRESS] 11/12 (91.7%) - CAI-RUH Chunk 2 done
[FALLBACK-FARE][OK] Created fallback fare for MS-8246: 778 SAR (itinerary: MS2_0_14994-f1bb9648...)
[FALLBACK-FARE][OK] Created fallback fare for SM-464: 662 SAR (itinerary: SM1_0_30580-f1bb9648...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 2 (1 filtered)
10:35:33 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-30: 2 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-30: 2 flight cards
10:35:33 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-28
[SESSION PROGRESS] Time: 01:03 | LF Workers: 9 active | LF Progress: 11/12 (91.7%) | OAL: Pass 2/2 | Routes: 0/4          [FARE-FAMILIES][WARNING] HTTP 400 for itinerary 4397d09cE5-4d94954e_E5_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary 3c81fcd4E5-4d94954e_E5_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary 438ba24eF3-52bcbf03_F3_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary f3ca39fbF3-52bcbf03_F3_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary 6d043e82F3-52bcbf03_F3_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary cc1d976bF3-52bcbf03_F3_ONE
[SESSION PROGRESS] Time: 01:05 | LF Workers: 9 active | LF Progress: 11/12 (91.7%) | OAL: Pass 2/2 | Routes: 0/4          [FALLBACK-FARE][OK] Created fallback fare for MS-8246: 778 SAR (itinerary: MS2_0_97209-ecaf53b5...)
[FALLBACK-FARE][OK] Created fallback fare for SM-464: 728 SAR (itinerary: SM1_0_80278-ecaf53b5...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 2 (3 filtered)
10:35:37 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-28: 2 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-28: 2 flight cards
10:35:37 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-27
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary ab69dd04XY-541445fd_XY_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary dd529c8eXY-541445fd_XY_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary e628756cXY-541445fd_XY_ONE
[SESSION PROGRESS] Time: 01:07 | LF Workers: 9 active | LF Progress: 11/12 (91.7%) | OAL: Pass 2/2 | Routes: 0/4          [FARE-FAMILIES][WARNING] HTTP 400 for itinerary 39f49bd2XY-541445fd_XY_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary baed452aXY-541445fd_XY_ONE
[FARE-FAMILIES][WARNING] HTTP 400 for itinerary 72bf7a5fXY-541445fd_XY_ONE
[SESSION PROGRESS] Time: 01:09 | LF Workers: 9 active | LF Progress: 11/12 (91.7%) | OAL: Pass 2/2 | Routes: 0/4          [FARE-FAMILIES][WARNING] HTTP 400 for itinerary e5c670f6XY-541445fd_XY_ONE
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:35:41 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-27: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-27: 0 flight cards
10:35:41 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-26
[SESSION PROGRESS] Time: 01:11 | LF Workers: 9 active | LF Progress: 11/12 (91.7%) | OAL: Pass 2/2 | Routes: 0/4          [OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 518 SAR (itinerary: NP3_0_30992-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 545 SAR (itinerary: MS5_0_23773-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 530 SAR (itinerary: MS4_0_82873-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 627 SAR (itinerary: MS6_0_87880-5b59763e...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 405 SAR (itinerary: SM1_0_28146-5b59763e...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 124 itineraries, kept 26 (98 filtered)
10:35:42 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-04: 55 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-04: 55 flight cards
10:35:42 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2026-01-01
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 416 SAR (itinerary: NP3_0_87068-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 596 SAR (itinerary: MS4_0_66595-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 606 SAR (itinerary: MS5_0_62989-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 714 SAR (itinerary: MS8_0_48236-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for NE-161: 401 SAR (itinerary: NE1_0_41053-d180fad1...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 405 SAR (itinerary: SM2_0_52447-d180fad1...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 127 itineraries, kept 25 (102 filtered)
10:35:42 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-03: 52 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-03: 52 flight cards
10:35:42 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-31
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 416 SAR (itinerary: NP1_0_16802-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 691 SAR (itinerary: MS7_0_25260-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 627 SAR (itinerary: MS4_0_69325-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 627 SAR (itinerary: MS4_1_29009-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 564 SAR (itinerary: SM3_0_18849-fd62a012...)
[FALLBACK-FARE][OK] Created fallback fare for NP-252: 518 SAR (itinerary: NP2_0_31006-fd62a012...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 130 itineraries, kept 25 (105 filtered)
10:35:43 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-05: 52 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-05: 52 flight cards
10:35:43 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-30
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 671 SAR (itinerary: MS3_0_24262-3c2e0e67...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 606 SAR (itinerary: MS2_0_74898-3c2e0e67...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 706 SAR (itinerary: MS6_0_78596-3c2e0e67...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 564 SAR (itinerary: SM1_0_31062-3c2e0e67...)
  [DEBUG] Extracted 50 unique fare options
[OAL] Filtering stats: found 150 itineraries, kept 23 (127 filtered)
10:35:43 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-02: 50 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-02: 50 flight cards
10:35:43 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-29
[OAL][ASYNC] [OK] Completed fetch: 20 results
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 6,037 EGP (itinerary: NP2_0_64113-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 8,201 EGP (itinerary: MS10_0_92573-8aa13e0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 6,986 EGP (itinerary: MS6_0_32854-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 7,543 EGP (itinerary: MS8_0_52563-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 5,796 EGP (itinerary: SM1_0_78966-8aa13e08...)
[FALLBACK-FARE][OK] Created fallback fare for NP-251: 6,037 EGP (itinerary: NP3_0_18013-8aa13e08...)
  [DEBUG] Extracted 54 unique fare options
[OAL] Filtering stats: found 126 itineraries, kept 26 (100 filtered)
10:35:43 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-05: 54 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-05: 54 flight cards
10:35:43 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2026-01-01
[SESSION PROGRESS] Time: 01:13 | LF Workers: 9 active | LF Progress: 11/12 (91.7%) | OAL: Pass 2/2 | Routes: 0/4          10:35:44 | INFO     | orchestration.queue_worker_system | [RESULT] Worker_9226 completed CAI-RUH (Tier 0: Range 1, Chunk 3/3)
10:35:44 | INFO     | market-insights-queue | worker_completed
10:35:44 | INFO     | orchestration.queue_worker_system | [PROGRESS] 12/12 (100.0%) - CAI-RUH Chunk 3 done
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for E5-415: 7,694 EGP (itinerary: 3c81fcd4E5-4d94954e_...)
[FALLBACK-FARE][OK] Created fallback fare for E5-410: 5,566 EGP (itinerary: 4397d09cE5-4d94954e_...)
[FALLBACK-FARE][OK] Created fallback fare for F3-612: 6,948 EGP (itinerary: cc1d976bF3-52bcbf03_...)
[FALLBACK-FARE][OK] Created fallback fare for F3-608: 8,087 EGP (itinerary: f3ca39fbF3-52bcbf03_...)
[FALLBACK-FARE][OK] Created fallback fare for F3-606: 6,568 EGP (itinerary: 6d043e82F3-52bcbf03_...)
[FALLBACK-FARE][OK] Created fallback fare for F3-616: 6,948 EGP (itinerary: 438ba24eF3-52bcbf03_...)
[FALLBACK-FARE][OK] Created fallback fare for XY-266: 6,948 EGP (itinerary: ab69dd04XY-541445fd_...)
[FALLBACK-FARE][OK] Created fallback fare for XY-276: 6,948 EGP (itinerary: dd529c8eXY-541445fd_...)
[FALLBACK-FARE][OK] Created fallback fare for XY-268: 7,708 EGP (itinerary: e628756cXY-541445fd_...)
[FALLBACK-FARE][OK] Created fallback fare for XY-272: 7,708 EGP (itinerary: 72bf7a5fXY-541445fd_...)
[FALLBACK-FARE][OK] Created fallback fare for XY-264: 8,594 EGP (itinerary: baed452aXY-541445fd_...)
[FALLBACK-FARE][OK] Created fallback fare for XY-274: 6,948 EGP (itinerary: 39f49bd2XY-541445fd_...)
[FALLBACK-FARE][OK] Created fallback fare for XY-270: 6,948 EGP (itinerary: e5c670f6XY-541445fd_...)
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 9,075 EGP (itinerary: NP9_0_85542-21488c3a...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 8,935 EGP (itinerary: MS8_0_30517-21488c3a...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,100 EGP (itinerary: MS4_0_86852-21488c3a...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS10_0_23892-21488c3...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 7,619 EGP (itinerary: SM3_0_85272-21488c3a...)
  [DEBUG] Extracted 31 unique fare options
[OAL] Filtering stats: found 113 itineraries, kept 26 (87 filtered)
10:35:44 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-04: 31 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-04: 31 flight cards
10:35:44 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-31
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 9,075 EGP (itinerary: NP4_0_29416-95834f1d...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 17,757 EGP (itinerary: MS19_0_66579-95834f1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 12,226 EGP (itinerary: MS8_0_15663-95834f1d...)
[FALLBACK-FARE][OK] Created fallback fare for NE-160: 7,923 EGP (itinerary: NE1_0_20807-95834f1d...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 8,454 EGP (itinerary: SM3_0_14786-95834f1d...)
  [DEBUG] Extracted 47 unique fare options
[OAL] Filtering stats: found 98 itineraries, kept 24 (74 filtered)
10:35:44 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-03: 47 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-03: 47 flight cards
10:35:44 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-30
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 6 itineraries, kept 0 (6 filtered)
10:35:44 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-ATZ 2025-12-26: 0 cards (all providers complete)
[OAL][SUCCESS] RUH-ATZ 2025-12-26: 0 flight cards
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 10,682 EGP (itinerary: MS17_0_51887-33bc975...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 9,568 EGP (itinerary: MS8_0_94480-33bc9758...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 10,581 EGP (itinerary: MS16_0_43558-33bc975...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 8,454 EGP (itinerary: SM7_0_79485-33bc9758...)
  [DEBUG] Extracted 46 unique fare options
[OAL] Filtering stats: found 121 itineraries, kept 23 (98 filtered)
10:35:44 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-02: 46 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-02: 46 flight cards
10:35:44 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-29
[OAL][ASYNC] Fetching fare families for 19 itineraries...
10:35:44 | WARNING  | market_insights.oal.search_async | [OAL][FAILED] RUH-ATZ 2026-01-05: No results from API → Recovery
[OAL][FAILED] RUH-ATZ 2026-01-05: No results → Recovery Queue
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] Fetching fare families for 21 itineraries...
[OAL][ASYNC] Fetching fare families for 20 itineraries...
[OAL][ASYNC] Fetching fare families for 21 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[SESSION PROGRESS] Time: 01:15 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 0/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 20 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 0 (5 filtered)
10:35:47 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete (0 cards) → Recovery Queue
10:35:47 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-31
[OAL][ASYNC] Fetching fare families for 1 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:35:47 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete (0 cards) → Recovery Queue
[SESSION PROGRESS] Time: 01:17 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 0/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:35:49 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete (0 cards) → Recovery Queue
10:35:49 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-30
[SESSION PROGRESS] Time: 01:19 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 0/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:35:50 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete (0 cards) → Recovery Queue
10:35:50 | INFO     | core.shared_storage | [OAL] Merged 2 existing + 2 new = 2 cards for RUH-ATZ 2025-12-31
10:35:50 | INFO     | core.shared_storage | [OAL] Merged 2 existing + 2 new = 2 cards for RUH-ATZ 2025-12-30
10:35:50 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-05: [Pass2] FAILED: API returned no data (timeout or blocked)
10:35:50 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-01: [Pass2] PARTIAL: polling incomplete (0 partial cards)
10:35:50 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2025-12-29: [Pass2] PARTIAL: polling incomplete (0 partial cards)
[OAL] RUH-ATZ: 4/11 dates OK, 3 errors
10:35:50 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: RUH-ATZ - 4 OK, 3 errors
10:35:50 | INFO     | orchestration.queue_worker_system | [OAL] RUH-ATZ: Starting alternatives (protected from early exit)
10:35:50 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Reusing RUH-CAI results for RUH-ATZ alternatives (not fetching again)
10:35:50 | INFO     | orchestration.queue_worker_system | [OAL] RUH-ATZ: Completed alternatives processing
[FALLBACK-FARE][OK] Created fallback fare for MS-8239: 14,036 EGP (itinerary: MS2_0_92475-c909fe6f...)
[FALLBACK-FARE][OK] Created fallback fare for SM-465: 8,619 EGP (itinerary: SM1_0_33157-c909fe6f...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 2 (1 filtered)
10:35:51 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2025-12-31: 2 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2025-12-31: 2 flight cards
10:35:51 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-29
[SESSION PROGRESS] Time: 01:21 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 1 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:35:52 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete (3 cards) → Recovery Queue
10:35:52 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-28
[SESSION PROGRESS] Time: 01:23 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 1 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 594 SAR (itinerary: MS7_0_87056-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 437 SAR (itinerary: MS1_0_69770-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 530 SAR (itinerary: MS6_0_24797-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 450 SAR (itinerary: SM3_0_63427-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 450 SAR (itinerary: SM2_0_90990-18ae80d9...)
[FALLBACK-FARE][OK] Created fallback fare for NP-252: 518 SAR (itinerary: NP5_0_82551-18ae80d9...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 82 itineraries, kept 25 (57 filtered)
10:35:55 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-31: 52 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-31: 52 flight cards
10:35:55 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-28
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 891 SAR (itinerary: MS10_0_90418-b4cfdf0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 706 SAR (itinerary: MS3_0_17972-b4cfdf01...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 1,006 SAR (itinerary: MS15_0_39891-b4cfdf0...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 405 SAR (itinerary: SM1_0_11875-b4cfdf01...)
[FALLBACK-FARE][OK] Created fallback fare for NP-252: 518 SAR (itinerary: NP2_0_93923-b4cfdf01...)
  [DEBUG] Extracted 51 unique fare options
[OAL] Filtering stats: found 124 itineraries, kept 24 (100 filtered)
10:35:55 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2026-01-01: 51 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2026-01-01: 51 flight cards
10:35:55 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-27
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:35:55 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete (3 cards) → Recovery Queue
10:35:55 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-27
[SESSION PROGRESS] Time: 01:25 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[FALLBACK-FARE][OK] Created fallback fare for MS-8245: 15,530 EGP (itinerary: MS4_0_87620-1916b65c...)
[FALLBACK-FARE][OK] Created fallback fare for SM-463: 9,416 EGP (itinerary: SM2_0_25590-1916b65c...)
  [DEBUG] Extracted 2 unique fare options
[OAL] Filtering stats: found 7 itineraries, kept 2 (5 filtered)
10:35:56 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2025-12-28: 2 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2025-12-28: 2 flight cards
10:35:56 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-26
[OAL][ASYNC] [OK] Completed fetch: 1 results
[FALLBACK-FARE][OK] Created fallback fare for MS-8245: 14,036 EGP (itinerary: MS2_0_97655-62fc593_...)
[FALLBACK-FARE][OK] Created fallback fare for SM-463: 8,619 EGP (itinerary: SM1_0_38364-62fc593_...)
  [DEBUG] Extracted 5 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 3 (1 filtered)
10:35:57 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] ATZ-RUH 2025-12-30: 5 cards (all providers complete)
[OAL][SUCCESS] ATZ-RUH 2025-12-30: 5 flight cards
[SESSION PROGRESS] Time: 01:27 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] [OK] Completed fetch: 20 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 358 SAR (itinerary: MS1_0_34924-2a0effe2...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 437 SAR (itinerary: MS3_0_32408-2a0effe2...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 397 SAR (itinerary: SM2_0_94608-2a0effe2...)
  [DEBUG] Extracted 51 unique fare options
[OAL] Filtering stats: found 104 itineraries, kept 23 (81 filtered)
10:35:58 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-29: 51 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-29: 51 flight cards
10:35:58 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-CAI 2025-12-26
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 594 SAR (itinerary: MS5_0_45248-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 445 SAR (itinerary: MS1_0_93176-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 530 SAR (itinerary: MS4_0_23042-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 450 SAR (itinerary: SM2_0_97811-b83017ff...)
[FALLBACK-FARE][OK] Created fallback fare for NE-161: 500 SAR (itinerary: NE3_0_84151-b83017ff...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 92 itineraries, kept 26 (66 filtered)
10:35:58 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-30: 55 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-30: 55 flight cards
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS8_0_51733-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,100 EGP (itinerary: MS4_0_89971-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS7_0_76644-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for NE-160: 5,607 EGP (itinerary: NE1_0_74272-9270d5a0...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 6,353 EGP (itinerary: SM2_0_46741-9270d5a0...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 114 itineraries, kept 26 (88 filtered)
10:35:58 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-30: 55 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-30: 55 flight cards
10:35:58 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-28
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS12_0_79993-84341fc...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 9,568 EGP (itinerary: MS11_1_50745-84341fc...)
[FALLBACK-FARE][OK] Created fallback fare for NE-164: 6,227 EGP (itinerary: NE3_0_19546-84341fcd...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS11_0_60378-84341fc...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 5,796 EGP (itinerary: SM1_0_11231-84341fcd...)
[FALLBACK-FARE][OK] Created fallback fare for NP-251: 6,037 EGP (itinerary: NP2_0_65704-84341fcd...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 111 itineraries, kept 25 (86 filtered)
10:35:58 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2026-01-01: 52 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2026-01-01: 52 flight cards
10:35:58 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-27
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS12_0_15978-7c2bd19...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,834 EGP (itinerary: MS11_0_96474-7c2bd19...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 8,100 EGP (itinerary: MS9_0_74386-7c2bd194...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 5,796 EGP (itinerary: SM2_0_88264-7c2bd194...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 6,353 EGP (itinerary: SM4_0_94095-7c2bd194...)
[FALLBACK-FARE][OK] Created fallback fare for NP-251: 6,037 EGP (itinerary: NP3_0_64202-7c2bd194...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 118 itineraries, kept 25 (93 filtered)
10:35:58 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-31: 52 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-31: 52 flight cards
10:35:58 | INFO     | market_insights.oal.search_async | [OAL] Starting CAI-RUH 2025-12-26
[OAL][ASYNC] Fetching fare families for 21 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 20 results
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 9,669 EGP (itinerary: MS7_0_18509-d8258ce3...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,201 EGP (itinerary: MS5_0_33041-d8258ce3...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 6,353 EGP (itinerary: SM1_0_75532-d8258ce3...)
  [DEBUG] Extracted 51 unique fare options
[OAL] Filtering stats: found 124 itineraries, kept 23 (101 filtered)
10:35:59 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-29: 51 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-29: 51 flight cards
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[OAL][ASYNC] Fetching fare families for 21 itineraries...
[SESSION PROGRESS] Time: 01:29 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 19 itineraries...
[SESSION PROGRESS] Time: 01:31 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 01:33 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:36:05 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete (0 cards) → Recovery Queue
[SESSION PROGRESS] Time: 01:35 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 357 SAR (itinerary: NP2_0_38921-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 358 SAR (itinerary: MS3_0_39603-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 350 SAR (itinerary: MS1_0_22517-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 437 SAR (itinerary: MS5_0_16981-b2e56f0c...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 397 SAR (itinerary: SM4_0_42211-b2e56f0c...)
  [DEBUG] Extracted 55 unique fare options
[OAL] Filtering stats: found 109 itineraries, kept 26 (83 filtered)
10:36:07 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-28: 55 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-28: 55 flight cards
[SESSION PROGRESS] Time: 01:37 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 1/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for NP-152: 357 SAR (itinerary: NP2_0_50513-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 358 SAR (itinerary: MS3_0_91307-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 437 SAR (itinerary: MS5_0_43910-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 445 SAR (itinerary: MS6_0_87146-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for NE-161: 350 SAR (itinerary: NE1_0_27107-fc00bd58...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 397 SAR (itinerary: SM4_0_19612-fc00bd58...)
  [DEBUG] Extracted 52 unique fare options
[OAL] Filtering stats: found 121 itineraries, kept 25 (96 filtered)
10:36:09 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-27: 52 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-27: 52 flight cards
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-648: 445 SAR (itinerary: MS2_0_11220-8569318e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-650: 606 SAR (itinerary: MS4_0_89141-8569318e...)
[FALLBACK-FARE][OK] Created fallback fare for MS-652: 826 SAR (itinerary: MS10_0_67206-8569318...)
[FALLBACK-FARE][OK] Created fallback fare for SM-470: 397 SAR (itinerary: SM1_0_20610-8569318e...)
[FALLBACK-FARE][OK] Created fallback fare for SM-462: 450 SAR (itinerary: SM3_0_61817-8569318e...)
  [DEBUG] Extracted 51 unique fare options
[OAL] Filtering stats: found 110 itineraries, kept 24 (86 filtered)
10:36:09 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] RUH-CAI 2025-12-26: 51 cards (all providers complete)
[OAL][SUCCESS] RUH-CAI 2025-12-26: 51 flight cards
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for RUH-CAI 2026-01-04
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for RUH-CAI 2026-01-03
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 31 existing + 52 new = 52 cards for RUH-CAI 2026-01-05
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 15 existing + 50 new = 50 cards for RUH-CAI 2026-01-02
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 17 existing + 52 new = 52 cards for RUH-CAI 2025-12-31
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 51 existing + 51 new = 51 cards for RUH-CAI 2026-01-01
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 16 existing + 51 new = 51 cards for RUH-CAI 2025-12-29
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for RUH-CAI 2025-12-30
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for RUH-CAI 2025-12-28
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for RUH-CAI 2025-12-27
10:36:09 | INFO     | core.shared_storage | [OAL] Merged 51 existing + 51 new = 51 cards for RUH-CAI 2025-12-26
[OAL] RUH-CAI: 11/11 dates OK, 0 errors
10:36:09 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: RUH-CAI - 11 OK, 0 errors
10:36:09 | INFO     | orchestration.queue_worker_system | [OAL] RUH-CAI: Completed alternatives processing
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 12,226 EGP (itinerary: MS6_0_62314-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for NE-160: 6,834 EGP (itinerary: NE2_0_93126-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 6,923 EGP (itinerary: SM3_0_32174-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 6,670 EGP (itinerary: NP1_0_45828-b4bce099...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,834 EGP (itinerary: MS4_0_10053-b4bce099...)
  [DEBUG] Extracted 48 unique fare options
[OAL] Filtering stats: found 90 itineraries, kept 24 (66 filtered)
10:36:09 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-27: 48 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-27: 48 flight cards
[OAL][ASYNC] [OK] Completed fetch: 19 results
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 8,834 EGP (itinerary: MS4_0_90028-33b282e1...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS6_0_55287-33b282e1...)
[FALLBACK-FARE][OK] Created fallback fare for SM-469: 6,923 EGP (itinerary: SM2_0_56157-33b282e1...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 6,353 EGP (itinerary: SM1_0_29018-33b282e1...)
  [DEBUG] Extracted 47 unique fare options
[OAL] Filtering stats: found 123 itineraries, kept 23 (100 filtered)
10:36:09 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-26: 47 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-26: 47 flight cards
[SESSION PROGRESS] Time: 01:39 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 2/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] [OK] Completed fetch: 21 results
[FALLBACK-FARE][OK] Created fallback fare for NP-151: 7,277 EGP (itinerary: NP1_0_17078-c711bd6_...)
[FALLBACK-FARE][OK] Created fallback fare for MS-647: 12,226 EGP (itinerary: MS13_0_58713-c711bd6...)
[FALLBACK-FARE][OK] Created fallback fare for MS-649: 9,568 EGP (itinerary: MS6_1_22101-c711bd6_...)
[FALLBACK-FARE][OK] Created fallback fare for MS-651: 9,568 EGP (itinerary: MS6_0_12601-c711bd6_...)
[FALLBACK-FARE][OK] Created fallback fare for SM-461: 8,454 EGP (itinerary: SM3_0_50722-c711bd6_...)
  [DEBUG] Extracted 54 unique fare options
[OAL] Filtering stats: found 95 itineraries, kept 26 (69 filtered)
10:36:10 | INFO     | market_insights.oal.search_async | [OAL][SUCCESS] CAI-RUH 2025-12-28: 54 cards (all providers complete)
[OAL][SUCCESS] CAI-RUH 2025-12-28: 54 flight cards
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 54 existing + 54 new = 54 cards for CAI-RUH 2026-01-05
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 31 new = 68 cards for CAI-RUH 2026-01-04
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 47 existing + 47 new = 47 cards for CAI-RUH 2026-01-03
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 11 existing + 46 new = 46 cards for CAI-RUH 2026-01-02
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for CAI-RUH 2025-12-30
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for CAI-RUH 2026-01-01
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for CAI-RUH 2025-12-31
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 51 existing + 51 new = 51 cards for CAI-RUH 2025-12-29
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 48 existing + 48 new = 48 cards for CAI-RUH 2025-12-27
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 47 existing + 47 new = 47 cards for CAI-RUH 2025-12-26
10:36:10 | INFO     | core.shared_storage | [OAL] Merged 54 existing + 54 new = 54 cards for CAI-RUH 2025-12-28
[OAL] CAI-RUH: 11/11 dates OK, 0 errors
10:36:10 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: CAI-RUH - 11 OK, 0 errors
10:36:10 | INFO     | orchestration.queue_worker_system | [OAL] CAI-RUH: Completed alternatives processing
[OAL][ASYNC] Fetching fare families for 1 itineraries...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:36:11 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete (0 cards) → Recovery Queue
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:36:11 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete (3 cards) → Recovery Queue
10:36:11 | INFO     | core.shared_storage | [OAL] Merged 2 existing + 2 new = 2 cards for ATZ-RUH 2026-01-04
10:36:11 | INFO     | core.shared_storage | [OAL] Merged 2 existing + 2 new = 2 cards for ATZ-RUH 2025-12-31
10:36:11 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2026-01-03
10:36:11 | INFO     | core.shared_storage | [OAL] Merged 2 existing + 2 new = 2 cards for ATZ-RUH 2025-12-28
10:36:11 | INFO     | core.shared_storage | [OAL] Merged 5 existing + 5 new = 5 cards for ATZ-RUH 2025-12-30
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2025-12-27
10:36:12 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-05: [Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:12 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-02: [Pass2] PARTIAL: polling incomplete (0 partial cards)
[SESSION PROGRESS] Time: 01:41 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 3/4          10:36:12 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-03: [Pass2] PARTIAL: polling incomplete (3 partial cards)

[INFO] LF completed, waiting for OAL to finish...
10:36:12 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-01: [Pass2] PARTIAL: polling incomplete (3 partial cards)
10:36:12 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-29: [Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:12 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-26: [Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:12 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-27: [Pass2] PARTIAL: polling incomplete (3 partial cards)
[OAL] ATZ-RUH: 7/11 dates OK, 7 errors
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL] Pass 2: ATZ-RUH - 7 OK, 7 errors
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL] ATZ-RUH: Starting alternatives (protected from early exit)
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Reusing CAI-RUH results for ATZ-RUH alternatives (not fetching again)
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL] ATZ-RUH: Completed alternatives processing
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Processing 2 reuse mappings
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Copying RUH-CAI → RUH-ATZ
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 31 existing + 52 new = 52 cards for RUH-ATZ 2026-01-05_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for RUH-ATZ 2026-01-04_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for RUH-ATZ 2026-01-03_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 15 existing + 50 new = 50 cards for RUH-ATZ 2026-01-02_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 51 existing + 51 new = 51 cards for RUH-ATZ 2026-01-01_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 17 existing + 52 new = 52 cards for RUH-ATZ 2025-12-31_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for RUH-ATZ 2025-12-30_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 16 existing + 51 new = 51 cards for RUH-ATZ 2025-12-29_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for RUH-ATZ 2025-12-28_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for RUH-ATZ 2025-12-27_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 51 existing + 51 new = 51 cards for RUH-ATZ 2025-12-26_CAIRO
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Successfully reused 576 total cards from RUH-CAI for RUH-ATZ alternatives
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Copying CAI-RUH → ATZ-RUH
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 54 existing + 54 new = 54 cards for ATZ-RUH 2026-01-05_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 68 new = 68 cards for ATZ-RUH 2026-01-04_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 47 existing + 47 new = 47 cards for ATZ-RUH 2026-01-03_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 11 existing + 46 new = 46 cards for ATZ-RUH 2026-01-02_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for ATZ-RUH 2026-01-01_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 52 existing + 52 new = 52 cards for ATZ-RUH 2025-12-31_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 55 existing + 55 new = 55 cards for ATZ-RUH 2025-12-30_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 51 existing + 51 new = 51 cards for ATZ-RUH 2025-12-29_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 54 existing + 54 new = 54 cards for ATZ-RUH 2025-12-28_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 48 existing + 48 new = 48 cards for ATZ-RUH 2025-12-27_CAIRO
10:36:12 | INFO     | core.shared_storage | [OAL] Merged 47 existing + 47 new = 47 cards for ATZ-RUH 2025-12-26_CAIRO
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL-ALT-REUSE] Successfully reused 574 total cards from CAI-RUH for ATZ-RUH alternatives

[OAL] Pass 2 complete: 33 results, 10 errors

============================================================
[OAL] EXTRACTION COMPLETE (PARALLEL)
============================================================
[OAL] Total results: 63
[OAL] Total errors: 20
[OAL] Routes with data: 4/4
[OAL] Routes with errors: 2
[OAL] Problem routes: ['ATZ-RUH', 'RUH-ATZ']...
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL] All passes completed (PARALLEL): 63 results, 20 errors

============================================================
[OAL] RECOVERY RUN - 20 failed items to retry
============================================================
10:36:12 | INFO     | orchestration.queue_worker_system | [OAL] Starting Recovery Run for 20 failed items
[OAL] Recovery: 4 (route, pass) combinations with failures
[OAL]   ATZ-RUH Pass2: 7 dates
[OAL]   RUH-ATZ Pass2: 3 dates
[OAL]   ATZ-RUH Pass1: 7 dates
[OAL]   RUH-ATZ Pass1: 3 dates
[OAL] Recovery Mode: 2 routes × 2 dates
[OAL] Recovery Delays: 3.0s route, 1.0s date
[OAL] Recovery Rate Limiters: search=2.4/s, poll=2.4/s
[OAL][RECOVERY] ATZ-RUH Pass2: retrying 7 dates...
[OAL][RECOVERY] RUH-ATZ Pass2: retrying 3 dates...
10:36:12 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-03
10:36:12 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-29
10:36:13 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-29
10:36:13 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-01
[SESSION PROGRESS] Time: 01:43 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 01:45 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 01:47 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 1 itineraries...
[SESSION PROGRESS] Time: 01:49 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:36:20 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete (3 cards) → Recovery Queue
10:36:20 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-26
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:36:20 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete (0 cards) → Recovery Queue
10:36:20 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-05
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:36:20 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete (0 cards) → Recovery Queue
10:36:20 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-27
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:36:21 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete (0 cards) → Recovery Queue
[SESSION PROGRESS] Time: 01:51 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 01:53 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 01:55 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
10:36:27 | WARNING  | market_insights.oal.search_async | [OAL][FAILED] RUH-ATZ 2026-01-05: No results from API → Recovery
[OAL][FAILED] RUH-ATZ 2026-01-05: No results → Recovery Queue
10:36:27 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2025-12-29: [RECOVERY Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:27 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-01: [RECOVERY Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:27 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-05: [RECOVERY Pass2] FAILED: API returned no data (timeout or blocked)
[OAL][RECOVERY] RUH-ATZ Pass2: 0/3 recovered, 3 still failed
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:36:27 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete (0 cards) → Recovery Queue
10:36:27 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-01
[SESSION PROGRESS] Time: 01:57 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 1 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:36:29 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete (3 cards) → Recovery Queue
10:36:29 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-05
[SESSION PROGRESS] Time: 01:59 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][RECOVERY] ATZ-RUH Pass1: retrying 7 dates...
10:36:30 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-29
10:36:31 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-03
[SESSION PROGRESS] Time: 02:01 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 02:03 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 1 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:36:35 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete (3 cards) → Recovery Queue
10:36:35 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-02
[SESSION PROGRESS] Time: 02:05 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 0 (5 filtered)
10:36:37 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete (0 cards) → Recovery Queue
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 4 itineraries, kept 0 (4 filtered)
10:36:37 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-29: Incomplete (0 cards) → Recovery Queue
10:36:37 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-26
[SESSION PROGRESS] Time: 02:07 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 1 itineraries...
[SESSION PROGRESS] Time: 02:09 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:36:40 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-03: Incomplete (3 cards) → Recovery Queue
10:36:40 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2025-12-27
[SESSION PROGRESS] Time: 02:11 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:36:43 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete (0 cards) → Recovery Queue
10:36:43 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2026-01-03
10:36:43 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2025-12-27
10:36:43 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2026-01-01
10:36:43 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-03: [RECOVERY Pass2] PARTIAL: polling incomplete (3 partial cards)
10:36:43 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-29: [RECOVERY Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:43 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-26: [RECOVERY Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:43 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-27: [RECOVERY Pass2] PARTIAL: polling incomplete (3 partial cards)
10:36:43 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-01: [RECOVERY Pass2] PARTIAL: polling incomplete (3 partial cards)
10:36:43 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-05: [RECOVERY Pass2] PARTIAL: polling incomplete (0 partial cards)
10:36:43 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-02: [RECOVERY Pass2] PARTIAL: polling incomplete (0 partial cards)
[OAL][RECOVERY] ATZ-RUH Pass2: 3/7 recovered, 7 still failed
[SESSION PROGRESS] Time: 02:13 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:36:45 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-26: Incomplete (0 cards) → Recovery Queue
10:36:45 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-01
[SESSION PROGRESS] Time: 02:15 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][RECOVERY] RUH-ATZ Pass1: retrying 3 dates...
10:36:46 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2025-12-29
[OAL][ASYNC] Fetching fare families for 1 itineraries...
10:36:48 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-01
[SESSION PROGRESS] Time: 02:17 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:36:48 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2025-12-27: Incomplete (3 cards) → Recovery Queue
10:36:48 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-05
[SESSION PROGRESS] Time: 02:19 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 02:21 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[OAL][ASYNC] Fetching fare families for 1 itineraries...
[OAL][ASYNC] [OK] Completed fetch: 1 results
  [DEBUG] Extracted 3 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 1 (4 filtered)
10:36:53 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete - 3 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-01: Incomplete (3 cards) → Recovery Queue
10:36:53 | INFO     | market_insights.oal.search_async | [OAL] Starting ATZ-RUH 2026-01-02
[SESSION PROGRESS] Time: 02:23 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 2 itineraries, kept 0 (2 filtered)
10:36:54 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2025-12-29: Incomplete (0 cards) → Recovery Queue
10:36:54 | INFO     | market_insights.oal.search_async | [OAL] Starting RUH-ATZ 2026-01-05
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:36:55 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] RUH-ATZ 2026-01-01: Incomplete (0 cards) → Recovery Queue
[SESSION PROGRESS] Time: 02:25 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 5 itineraries, kept 0 (5 filtered)
10:36:56 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-05: Incomplete (0 cards) → Recovery Queue
[SESSION PROGRESS] Time: 02:27 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 02:29 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
  [DEBUG] Extracted 0 unique fare options
[OAL] Filtering stats: found 3 itineraries, kept 0 (3 filtered)
10:37:00 | WARNING  | market_insights.oal.search_async | [OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete - 0 partial cards → Recovery
[OAL][PARTIAL] ATZ-RUH 2026-01-02: Incomplete (0 cards) → Recovery Queue
10:37:00 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2026-01-03
10:37:00 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2025-12-27
10:37:00 | INFO     | core.shared_storage | [OAL] Merged 3 existing + 3 new = 3 cards for ATZ-RUH 2026-01-01
10:37:00 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-29: [RECOVERY Pass1] PARTIAL: polling incomplete (0 partial cards)
10:37:00 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-03: [RECOVERY Pass1] PARTIAL: polling incomplete (3 partial cards)
10:37:00 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-26: [RECOVERY Pass1] PARTIAL: polling incomplete (0 partial cards)
10:37:00 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2025-12-27: [RECOVERY Pass1] PARTIAL: polling incomplete (3 partial cards)
10:37:00 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-01: [RECOVERY Pass1] PARTIAL: polling incomplete (3 partial cards)
10:37:00 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-05: [RECOVERY Pass1] PARTIAL: polling incomplete (0 partial cards)
10:37:00 | WARNING  | core.shared_storage | [OAL] Error for ATZ-RUH 2026-01-02: [RECOVERY Pass1] PARTIAL: polling incomplete (0 partial cards)
[OAL][RECOVERY] ATZ-RUH Pass1: 3/7 recovered, 7 still failed
10:37:01 | WARNING  | market_insights.oal.search_async | [OAL][FAILED] RUH-ATZ 2026-01-05: No results from API → Recovery
[OAL][FAILED] RUH-ATZ 2026-01-05: No results → Recovery Queue
10:37:01 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2025-12-29: [RECOVERY Pass1] PARTIAL: polling incomplete (0 partial cards)
10:37:01 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-01: [RECOVERY Pass1] PARTIAL: polling incomplete (0 partial cards)
10:37:01 | WARNING  | core.shared_storage | [OAL] Error for RUH-ATZ 2026-01-05: [RECOVERY Pass1] FAILED: API returned no data (timeout or blocked)
[OAL][RECOVERY] RUH-ATZ Pass1: 0/3 recovered, 3 still failed
[SESSION PROGRESS] Time: 02:31 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...
[SESSION PROGRESS] Time: 02:33 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] LF completed, waiting for OAL to finish...

============================================================
[OAL] RECOVERY COMPLETE
============================================================
[OAL] Recovered: 6 items
[OAL] Still failed: 0 items
10:37:04 | INFO     | orchestration.queue_worker_system | [OAL] Recovery complete: 6 recovered, 0 still failed
10:37:04 | INFO     | orchestration.queue_worker_system | OALProcessor completed all passes successfully
10:37:04 | INFO     | orchestration.queue_worker_system | OALProcessor finished (completed: True)
[SESSION PROGRESS] Time: 02:35 | LF Workers: 9 active | LF Progress: 12/12 (100.0%) | OAL: Pass 2/2 | Routes: 4/4          
[INFO] All processing completed (LF + OAL)!

[STEP 8.5] Running Today's Flights supplement scan...
10:37:06 | INFO     | managers.chunk_state_manager | [CHUNK_STATE] Database schema initialized
10:37:06 | INFO     | managers.chunk_state_manager | [CHUNK_STATE] Initialized with db_path=D:\CODERED\LAB\market_insights\managers\outputs\checkpoints\chunk_state.db
10:37:06 | INFO     | managers.checkpoint_manager | [CHECKPOINT] Using SQLite backend (recommended)
10:37:06 | INFO     | managers.checkpoint_manager | CheckpointManager initialized: D:\CODERED\LAB\market_insights\managers\outputs\checkpoints (backend: SQLite)
[SUPPLEMENT] Connecting to Chrome on port 9222...
[LF][[OK] SUCCESS] Connected to Chrome on 127.0.0.1:9222 (after 1 attempts)
[LF][[OK] SUCCESS] Found Amadeus Altea window: Altéa Reservation Desktop
[LF][[INFO] INFO] URL: https://tc212.resdesktop.altea.amadeus.com/app_ard/apf/init/login?SITE=ESMPESMP&LANGUAGE=GB&MARKETS=ARDW_PROD_WBP&ACTION=clpLogin
10:37:08 | WARNING  | orchestration.queue_worker_system | [SUPPLEMENT] Today's supplement scan failed: No module named 'market_insights.utils.amadeus'
[WARNING] Today's supplement scan skipped: No module named 'market_insights.utils.amadeus'

[SHUTDOWN] Signaling workers and writer to stop...

[STEP 9] Writing Excel files (mode=BY_DIRECTION)...

[OAL DATA CHECK]
  Routes with OAL data: 4/4
  Total OAL dates collected: 55
  0/2 groups written incrementally
  Writing 2 remaining groups...
10:37:08 | INFO     | orchestration.queue_worker_system | [EXCEL] Writing 2 remaining groups (mode=BY_DIRECTION)...
[EXCEL] Writing 2 remaining groups (mode=BY_DIRECTION)...
10:37:08 | INFO     | orchestration.queue_worker_system | [EXCEL] Writing group: EGY -> KSA (2 routes)
[EXCEL] Writing group: EGY -> KSA (2 routes)
10:37:08 | INFO     | orchestration.queue_worker_system | [EXCEL] Queued write request for EGY -> KSA
10:37:08 | INFO     | ExcelWriter | [WRITER] Processing write request: EGY -> KSA
10:37:08 | INFO     | orchestration.queue_worker_system | [EXCEL] Writing group: KSA -> EGY (2 routes)
[EXCEL] Writing group: KSA -> EGY (2 routes)
10:37:08 | INFO     | orchestration.queue_worker_system | [EXCEL] Queued write request for KSA -> EGY
10:37:08 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] CAI-RUH: LF=11 dates, OAL=11 dates
10:37:08 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] ATZ-RUH: LF=11 dates, OAL=22 dates
10:37:08 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Group EGY_TO_KSA data summary: LF=22 dates, OAL=33 dates
10:37:09 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Building 2 routes with OpenPyXL Engine (THREATS ALERT + LOAD FACTOR + OAL)...
[EXCEL] Creating sheets for 2 routes...
[EXCEL] Creating sheets for CAI-RUH...
[LOAD FACTOR] Written 13 rows for CAI-RUH
[LOAD FACTOR] Written 9 connecting passengers rows
[EXCEL] Created CAI-RUH LOAD FACTOR sheet
[FORMAT] Applying table formatting to LF sheet (LOAD FACTOR) 'CAI-RUH LOAD FACTOR'...
[TABLE] Found 'Outbound Connections' at row 19, main table ends at row 15
[TABLE] Found Outbound Connections header at row 20, main table ends at row 15
[TABLE] Creating Excel Table 'Table_CAI_RUH_LOAD_FACTOR' for sheet 'CAI-RUH LOAD FACTOR' (max_row=29, max_col=36)...
[TABLE] Excel Table 'Table_CAI_RUH_LOAD_FACTOR' created: 14 data rows (Total Row enabled)
[TABLE] Main LF table ends at row 15 (Outbound Connections table is separate)
[TABLE] totalsRowShown=True in openpyxl, Excel COM will update with correct formulas
[TABLE] Creating Outbound Connections table 'Table_CAI_RUH_LOAD_FACTOR_Connections_Connections' from row 20 to 29...
[TABLE] Outbound Connections table 'Table_CAI_RUH_LOAD_FACTOR_Connections_Connections' created: 9 data rows
[FORMAT] Applied number formats to 36 columns in sheet 'CAI-RUH LOAD FACTOR'
[OAL] Built LF lookup with 13 flight entries
[OAL] Collected 574 rows for CAI-RUH
[OAL] Created Table 'Table_CAI_RUH_OAL'
[EXCEL] [OK] Created OAL sheet: 'CAI-RUH OAL' with 574 flights
[EXCEL]    - LF Comments prepared for 13 Air Cairo rows
[EXCEL]    - Table name: Table_CAI_RUH_OAL
[EXCEL] Created CAI-RUH OAL sheet
[THREATS ALERT-LF] Processing 2 LF rows for 2025-12-26 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 2 flights: ['SM461', 'SM469']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2025-12-26, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-26', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.10
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flyadeal F3-606 (LF=0.7765)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-26', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-274 (LF=0.7765)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-26', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-270 (LF=0.7765)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-26', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.43
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Air Arabia Egypt E5-410 (LF=0.7765)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-26', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.38
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-649 (LF=0.7765)
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-27 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM461']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2025-12-27, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-27', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.20
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Nile Air NP-151 (LF=0.5922)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-27', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.07
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Nesma Airlines NE-160 (LF=0.5922)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-27', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.38
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs EgyptAir MS-649 (LF=0.5922)
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-28 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM461']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2025-12-28, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.31
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flyadeal F3-608 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.31
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flyadeal F3-606 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.91
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flyadeal F3-612 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.91
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flyadeal F3-616 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.57
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-276 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.57
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-268 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.57
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-274 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.57
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-270 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.07
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-266 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.07
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-272 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.07
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-264 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.57
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Air Arabia Egypt E5-410 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.93
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Nile Air NP-151 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.68
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-324 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.68
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-312 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.68
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-418 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.01
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs EgyptAir MS-649 (LF=0.8899)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-28', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.01
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs EgyptAir MS-651 (LF=0.8899)
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-29 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM469']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2025-12-29, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-29', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-266 (LF=0.5341)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-29', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-268 (LF=0.5341)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-29', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-272 (LF=0.5341)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-29', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-274 (LF=0.5341)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-29', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-270 (LF=0.5341)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-29', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.26
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Air Arabia Egypt E5-410 (LF=0.5341)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-29', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.43
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-649 (LF=0.5341)
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-30 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM469']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2025-12-30, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-266 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-276 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-268 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-264 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-274 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs flynas XY-270 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.67
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Air Arabia Egypt E5-415 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.23
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Air Arabia Egypt E5-410 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.59
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Nesma Airlines NE-160 (LF=0.4469)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.51
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-649 (LF=0.4469)
[THREATS ALERT-LF] Processing 2 LF rows for 2025-12-31 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 2 flights: ['SM461', 'SM469']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2025-12-31, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.05
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Air Arabia Egypt E5-415 (LF=0.3687)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.07
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-651 (LF=0.3687)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-266 (LF=0.3631)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-272 (LF=0.3631)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-264 (LF=0.3631)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-274 (LF=0.3631)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.41
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs flynas XY-270 (LF=0.3631)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.49
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Air Arabia Egypt E5-415 (LF=0.3631)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.25
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Nile Air NP-251 (LF=0.3631)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2025-12-31', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.51
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs EgyptAir MS-651 (LF=0.3631)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-01 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM461']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2026-01-01, currency=EGP
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-02 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM469']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2026-01-02, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-02', 'currency': 'EGP'}, ac_flight=SM-469, delta=1.23
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Air Arabia Egypt E5-410 (LF=0.6872)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-02', 'currency': 'EGP'}, ac_flight=SM-469, delta=1.01
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-649 (LF=0.6872)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-02', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.21
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-651 (LF=0.6872)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-02', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.13
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-647 (LF=0.6872)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-03 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM461']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2026-01-03, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-03', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.42
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Nesma Airlines NE-160 (LF=0.5642)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-04 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM461']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2026-01-04, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.62
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Air Arabia Egypt E5-410 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.77
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-320 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.02
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-324 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.02
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-310 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.02
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-312 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.02
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs Saudia SV-418 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=1.51
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs EgyptAir MS-649 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.85
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs EgyptAir MS-647 (LF=0.5505)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-04', 'currency': 'EGP'}, ac_flight=SM-461, delta=0.35
[THREAT-HOOK-DEBUG] Added threat: SM-461 vs EgyptAir MS-651 (LF=0.5505)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-05 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM469']...
[THREAT-CONTEXT-DEBUG] Set context: route=CAI-RUH, date=2026-01-05, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-05', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.23
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs Air Arabia Egypt E5-410 (LF=0.3296)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-05', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.95
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-649 (LF=0.3296)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'CAI-RUH', 'date_str': '2026-01-05', 'currency': 'EGP'}, ac_flight=SM-469, delta=0.51
[THREAT-HOOK-DEBUG] Added threat: SM-469 vs EgyptAir MS-651 (LF=0.3296)
[MACRO1-EQUIV] Skipping THREATS ALERT sheet: CAI-RUH THREATS ALERT (fonts set elsewhere)
[FORMAT] Applied number formats to 18 columns in sheet 'CAI-RUH THREATS ALERT'
[WRAP TEXT] Applied wrap_text to 55086 cells, skipped 942 merged cells
[ROW HEIGHT] Set header heights: Row 1-2: 30.6, Row 3: 38.4
[EXCEL] Created CAI-RUH THREATS ALERT sheet
[EXCEL] Creating sheets for ATZ-RUH...
[LOAD FACTOR] Written 4 rows for ATZ-RUH
[LOAD FACTOR] Written 3 connecting passengers rows
[EXCEL] Created ATZ-RUH LOAD FACTOR sheet
[FORMAT] Applying table formatting to LF sheet (LOAD FACTOR) 'ATZ-RUH LOAD FACTOR'...
[TABLE] Found 'Outbound Connections' at row 10, main table ends at row 6
[TABLE] Found Outbound Connections header at row 11, main table ends at row 6
[TABLE] Creating Excel Table 'Table_ATZ_RUH_LOAD_FACTOR' for sheet 'ATZ-RUH LOAD FACTOR' (max_row=14, max_col=36)...
[TABLE] Excel Table 'Table_ATZ_RUH_LOAD_FACTOR' created: 5 data rows (Total Row enabled)
[TABLE] Main LF table ends at row 6 (Outbound Connections table is separate)
[TABLE] totalsRowShown=True in openpyxl, Excel COM will update with correct formulas
[TABLE] Creating Outbound Connections table 'Table_ATZ_RUH_LOAD_FACTOR_Connections_Connections' from row 11 to 14...
[TABLE] Outbound Connections table 'Table_ATZ_RUH_LOAD_FACTOR_Connections_Connections' created: 3 data rows
[FORMAT] Applied number formats to 36 columns in sheet 'ATZ-RUH LOAD FACTOR'
[OAL] Built LF lookup with 4 flight entries
[OAL] Collected 605 rows for ATZ-RUH
[OAL] Created Table 'Table_ATZ_RUH_OAL'
[EXCEL] [OK] Created OAL sheet: 'ATZ-RUH OAL' with 605 flights
[EXCEL]    - LF Comments prepared for 4 Air Cairo rows
[EXCEL]    - Table name: Table_ATZ_RUH_OAL
[EXCEL] Created ATZ-RUH OAL sheet
[THREATS ALERT-LF] WARNING: No LF rows provided for 2025-12-27
[THREATS ALERT-LF] WARNING: LF map is empty for 2025-12-27 (no matching flights found)
[THREATS ALERT] Merging 'Indirect competition' row 9, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 48 Cairo rows starting at row 10
[THREATS ALERT-CAIRO] note_row=9, original_oal_last_row=8, data_start_row=6
[THREATS ALERT-CAIRO] Cairo row 0: Cell(10,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(10,2) [FLIGHT NUM] = 'E5-410'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(10,3) [DEPARTURE] = '10:30'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(10,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 30 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(10,5) [AVAILABILITY] = '2 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(10,6) [PUBLISHED FARE] = '7,363 EGP'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(11,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(11,2) [FLIGHT NUM] = 'E5-410'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(11,3) [DEPARTURE] = '10:30'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(11,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 2 x 40 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(11,5) [AVAILABILITY] = '2 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(11,6) [PUBLISHED FARE] = '10,060 EGP'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 10 to 57
[THREAT-CONTEXT-DEBUG] Set context: route=ATZ-RUH, date=2025-12-27, currency=EGP
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-28 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM463']...
[THREATS ALERT] Merging 'Indirect competition' row 63, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 54 Cairo rows starting at row 64
[THREATS ALERT-CAIRO] note_row=63, original_oal_last_row=62, data_start_row=61
[THREATS ALERT-CAIRO] Cairo row 0: Cell(64,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(64,2) [FLIGHT NUM] = 'F3-612'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(64,3) [DEPARTURE] = '21:20'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(64,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 15 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(64,5) [AVAILABILITY] = '57 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(64,6) [PUBLISHED FARE] = '5,050 EGP'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(65,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(65,2) [FLIGHT NUM] = 'F3-612'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(65,3) [DEPARTURE] = '21:20'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(65,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 25 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(65,5) [AVAILABILITY] = '57 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(65,6) [PUBLISHED FARE] = '7,303 EGP'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 64 to 117
[THREAT-CONTEXT-DEBUG] Set context: route=ATZ-RUH, date=2025-12-28, currency=EGP
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-30 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM463']...
[THREATS ALERT] Merging 'Indirect competition' row 126, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 55 Cairo rows starting at row 127
[THREATS ALERT-CAIRO] note_row=126, original_oal_last_row=125, data_start_row=121
[THREATS ALERT-CAIRO] Cairo row 0: Cell(127,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(127,2) [FLIGHT NUM] = 'F3-612'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(127,3) [DEPARTURE] = '21:20'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(127,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 15 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(127,5) [AVAILABILITY] = '12 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(127,6) [PUBLISHED FARE] = '4,543 EGP'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(128,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(128,2) [FLIGHT NUM] = 'F3-612'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(128,3) [DEPARTURE] = '21:20'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(128,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 25 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(128,5) [AVAILABILITY] = '12 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(128,6) [PUBLISHED FARE] = '6,796 EGP'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 127 to 181
[THREAT-CONTEXT-DEBUG] Set context: route=ATZ-RUH, date=2025-12-30, currency=EGP
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'ATZ-RUH', 'date_str': '2025-12-30', 'currency': 'EGP'}, ac_flight=SM-463, delta=0.78
[THREAT-HOOK-DEBUG] Added threat: SM-463 vs flynas XY-284 (LF=0.7486)
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-31 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM465']...
[THREATS ALERT] Merging 'Indirect competition' row 187, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 52 Cairo rows starting at row 188
[THREATS ALERT-CAIRO] note_row=187, original_oal_last_row=186, data_start_row=185
[THREATS ALERT-CAIRO] Cairo row 0: Cell(188,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(188,2) [FLIGHT NUM] = 'E5-415'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(188,3) [DEPARTURE] = '01:15'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(188,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 30 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(188,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(188,6) [PUBLISHED FARE] = '5,731 EGP'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(189,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(189,2) [FLIGHT NUM] = 'E5-415'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(189,3) [DEPARTURE] = '01:15'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(189,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 2 x 40 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(189,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(189,6) [PUBLISHED FARE] = '8,428 EGP'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 188 to 239
[THREAT-CONTEXT-DEBUG] Set context: route=ATZ-RUH, date=2025-12-31, currency=EGP
[THREATS ALERT-LF] WARNING: No LF rows provided for 2026-01-01
[THREATS ALERT-LF] WARNING: LF map is empty for 2026-01-01 (no matching flights found)
[THREATS ALERT] Merging 'Indirect competition' row 246, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 52 Cairo rows starting at row 247
[THREATS ALERT-CAIRO] note_row=246, original_oal_last_row=245, data_start_row=243
[THREATS ALERT-CAIRO] Cairo row 0: Cell(247,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(247,2) [FLIGHT NUM] = 'E5-410'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(247,3) [DEPARTURE] = '10:30'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(247,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 30 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(247,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(247,6) [PUBLISHED FARE] = '6,441 EGP'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(248,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(248,2) [FLIGHT NUM] = 'E5-410'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(248,3) [DEPARTURE] = '10:30'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(248,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 2 x 40 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(248,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(248,6) [PUBLISHED FARE] = '9,138 EGP'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 247 to 298
[THREAT-CONTEXT-DEBUG] Set context: route=ATZ-RUH, date=2026-01-01, currency=EGP
[THREATS ALERT-LF] WARNING: No LF rows provided for 2026-01-03
[THREATS ALERT-LF] WARNING: LF map is empty for 2026-01-03 (no matching flights found)
[THREATS ALERT] Merging 'Indirect competition' row 305, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 47 Cairo rows starting at row 306
[THREATS ALERT-CAIRO] note_row=305, original_oal_last_row=304, data_start_row=302
[THREATS ALERT-CAIRO] Cairo row 0: Cell(306,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(306,2) [FLIGHT NUM] = 'F3-612'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(306,3) [DEPARTURE] = '21:20'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(306,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 15 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(306,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(306,6) [PUBLISHED FARE] = '13,656 EGP'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(307,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(307,2) [FLIGHT NUM] = 'F3-612'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(307,3) [DEPARTURE] = '21:20'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(307,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 25 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(307,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(307,6) [PUBLISHED FARE] = '15,909 EGP'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 306 to 352
[THREAT-CONTEXT-DEBUG] Set context: route=ATZ-RUH, date=2026-01-03, currency=EGP
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-04 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM463']...
[THREATS ALERT] Merging 'Indirect competition' row 358, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 68 Cairo rows starting at row 359
[THREATS ALERT-CAIRO] note_row=358, original_oal_last_row=357, data_start_row=356
[THREATS ALERT-CAIRO] Cairo row 0: Cell(359,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(359,2) [FLIGHT NUM] = 'E5-415'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(359,3) [DEPARTURE] = '01:15'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(359,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 30 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(359,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(359,6) [PUBLISHED FARE] = '7,694 EGP'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(360,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(360,2) [FLIGHT NUM] = 'E5-415'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(360,3) [DEPARTURE] = '01:15'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(360,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 2 x 40 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(360,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(360,6) [PUBLISHED FARE] = '10,391 EGP'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 359 to 426
[THREAT-CONTEXT-DEBUG] Set context: route=ATZ-RUH, date=2026-01-04, currency=EGP
[MACRO1-EQUIV] Skipping THREATS ALERT sheet: ATZ-RUH THREATS ALERT (fonts set elsewhere)
[FORMAT] Applied number formats to 18 columns in sheet 'ATZ-RUH THREATS ALERT'
[WRAP TEXT] Applied wrap_text to 38585 cells, skipped 699 merged cells
[ROW HEIGHT] Set header heights: Row 1-2: 30.6, Row 3: 38.4
[EXCEL] Created ATZ-RUH THREATS ALERT sheet
10:37:16 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Applying formatting...
[MACRO1] Processing worksheet: CAI-RUH LOAD FACTOR
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 29 rows x 36 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] [OK] Applied CENTER alignment to 420 cells, skipped 8 merged cells in LF sheet
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Processing worksheet: CAI-RUH OAL
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 575 rows x 8 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] Formatted 4600 cells, skipped 0 merged cells
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Skipping THREATS ALERT sheet: CAI-RUH THREATS ALERT (alignment handled separately)
[MACRO1] Processing worksheet: ATZ-RUH LOAD FACTOR
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 14 rows x 36 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] [OK] Applied CENTER alignment to 210 cells, skipped 8 merged cells in LF sheet
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Processing worksheet: ATZ-RUH OAL
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 606 rows x 8 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] Formatted 4848 cells, skipped 0 merged cells
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Skipping THREATS ALERT sheet: ATZ-RUH THREATS ALERT (alignment handled separately)
10:37:17 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Saved to temp file: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\.tmp_zphkzv0b.xlsx
10:37:17 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Atomic write completed: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\EGY_TO_KSA_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
[AUTOFIT] Loading workbook: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\EGY_TO_KSA_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
[AUTOFIT]   Processing sheet: CAI-RUH LOAD FACTOR
[AUTOFIT]   Processing sheet: CAI-RUH OAL
[AUTOFIT]   Processing sheet: CAI-RUH THREATS ALERT
[AUTOFIT]     Excluding column: G (preserving width: 25.0)
[AUTOFIT]   Processing sheet: ATZ-RUH LOAD FACTOR
[AUTOFIT]   Processing sheet: ATZ-RUH OAL
[AUTOFIT]   Processing sheet: ATZ-RUH THREATS ALERT
[AUTOFIT]     Excluding column: G (preserving width: 25.0)
[AUTOFIT] Saving workbook...
[AUTOFIT] [OK] AutoFit completed successfully
10:37:19 | INFO     | core.shared_storage | [FILE] Marked CAI-RUH as written
10:37:19 | INFO     | core.shared_storage | [FILE] Marked ATZ-RUH as written
[SUCCESS] Consolidated file saved: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\EGY_TO_KSA_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
  Routes included: 2
  Sheets per route: THREATS ALERT, LOAD FACTOR, OAL

[FILE SAVED] EGY -> KSA -> D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\EGY_TO_KSA_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
10:37:19 | INFO     | ExcelWriter | [WRITER] Written (1): EGY -> KSA -> D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\EGY_TO_KSA_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
10:37:19 | INFO     | ExcelWriter | [WRITER] Processing write request: KSA -> EGY
10:37:19 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] RUH-CAI: LF=11 dates, OAL=11 dates
10:37:19 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] RUH-ATZ: LF=11 dates, OAL=22 dates
10:37:19 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Group KSA_TO_EGY data summary: LF=22 dates, OAL=33 dates
10:37:19 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Building 2 routes with OpenPyXL Engine (THREATS ALERT + LOAD FACTOR + OAL)...
[EXCEL] Creating sheets for 2 routes...
[EXCEL] Creating sheets for RUH-CAI...
[LOAD FACTOR] Written 13 rows for RUH-CAI
[LOAD FACTOR] Written 9 connecting passengers rows
[EXCEL] Created RUH-CAI LOAD FACTOR sheet
[FORMAT] Applying table formatting to LF sheet (LOAD FACTOR) 'RUH-CAI LOAD FACTOR'...
[TABLE] Found 'Outbound Connections' at row 19, main table ends at row 15
[TABLE] Found Outbound Connections header at row 20, main table ends at row 15
[TABLE] Creating Excel Table 'Table_RUH_CAI_LOAD_FACTOR' for sheet 'RUH-CAI LOAD FACTOR' (max_row=29, max_col=36)...
[TABLE] Excel Table 'Table_RUH_CAI_LOAD_FACTOR' created: 14 data rows (Total Row enabled)
[TABLE] Main LF table ends at row 15 (Outbound Connections table is separate)
[TABLE] totalsRowShown=True in openpyxl, Excel COM will update with correct formulas
[TABLE] Creating Outbound Connections table 'Table_RUH_CAI_LOAD_FACTOR_Connections_Connections' from row 20 to 29...
[TABLE] Outbound Connections table 'Table_RUH_CAI_LOAD_FACTOR_Connections_Connections' created: 9 data rows
[FORMAT] Applied number formats to 36 columns in sheet 'RUH-CAI LOAD FACTOR'
[OAL] Built LF lookup with 13 flight entries
[OAL] Collected 576 rows for RUH-CAI
[OAL] Created Table 'Table_RUH_CAI_OAL'
[EXCEL] [OK] Created OAL sheet: 'RUH-CAI OAL' with 576 flights
[EXCEL]    - LF Comments prepared for 13 Air Cairo rows
[EXCEL]    - Table name: Table_RUH_CAI_OAL
[EXCEL] Created RUH-CAI OAL sheet
[THREATS ALERT-LF] Processing 2 LF rows for 2025-12-26 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 2 flights: ['SM462', 'SM470']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2025-12-26, currency=SAR
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-27 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM462']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2025-12-27, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2025-12-27', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.47
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Nesma Airlines NE-161 (LF=0.4464)
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-28 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM462']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2025-12-28, currency=SAR
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-29 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM470']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2025-12-29, currency=SAR
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-30 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM470']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2025-12-30, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2025-12-30', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.02
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Air Arabia Egypt E5-416 (LF=0.5238)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2025-12-30', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.10
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-652 (LF=0.5238)
[THREATS ALERT-LF] Processing 2 LF rows for 2025-12-31 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 2 flights: ['SM462', 'SM470']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2025-12-31, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2025-12-31', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.02
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Air Arabia Egypt E5-416 (LF=0.494)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2025-12-31', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.10
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-652 (LF=0.494)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-01 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM462']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2026-01-01, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-01', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-273 (LF=0.1667)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-01', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-263 (LF=0.1667)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-01', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-269 (LF=0.1667)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-01', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.44
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Air Arabia Egypt E5-411 (LF=0.1667)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-01', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.37
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Nile Air NP-252 (LF=0.1667)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-02 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM470']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2026-01-02, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.30
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flyadeal F3-615 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-273 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-263 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-269 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.55
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-265 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.55
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-267 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.55
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-275 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.55
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-271 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.98
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Air Arabia Egypt E5-411 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.98
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-650 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.33
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-648 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.98
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-652 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.74
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Saudia SV-321 (LF=0.3036)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-02', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.74
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Saudia SV-311 (LF=0.3036)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-03 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM462']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2026-01-03, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-265 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-275 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-263 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-271 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-269 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.39
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Air Arabia Egypt E5-411 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=1.54
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Nesma Airlines NE-161 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=1.39
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Nile Air NP-152 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.49
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs EgyptAir MS-648 (LF=0.2679)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-03', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.39
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs EgyptAir MS-650 (LF=0.2679)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-04 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM462']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2026-01-04, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=1.01
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Air Arabia Egypt E5-416 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.39
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Air Arabia Egypt E5-411 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-265 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-267 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-273 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-275 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-263 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-271 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.36
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs flynas XY-269 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.89
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Saudia SV-311 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.37
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs Nile Air NP-152 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=1.15
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs EgyptAir MS-650 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=1.00
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs EgyptAir MS-648 (LF=0.4124)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-04', 'currency': 'SAR'}, ac_flight=SM-462, delta=0.18
[THREAT-HOOK-DEBUG] Added threat: SM-462 vs EgyptAir MS-652 (LF=0.4124)
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-05 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM470']...
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-CAI, date=2026-01-05, currency=SAR
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-267 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-273 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-275 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-263 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.95
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-269 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.55
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-265 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.55
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs flynas XY-271 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=2.98
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Nile Air NP-152 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.96
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Nile Air NP-252 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.77
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-650 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.77
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-652 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=1.13
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs EgyptAir MS-648 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.74
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Saudia SV-313 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.74
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Saudia SV-311 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.74
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Saudia SV-315 (LF=0.2738)
[THREAT-HOOK-DEBUG] collector=<reports.threat_alert_report.collector.ThreatCollector object at 0x0000023ED61AF8C0>, context={'route': 'RUH-CAI', 'date_str': '2026-01-05', 'currency': 'SAR'}, ac_flight=SM-470, delta=0.74
[THREAT-HOOK-DEBUG] Added threat: SM-470 vs Saudia SV-417 (LF=0.2738)
[THREATS ALERT] Day 2026-01-05: NCU Delta=3.0 (DIRECT) -> GREEN gradient (LOW)
[MACRO1-EQUIV] Skipping THREATS ALERT sheet: RUH-CAI THREATS ALERT (fonts set elsewhere)
[FORMAT] Applied number formats to 18 columns in sheet 'RUH-CAI THREATS ALERT'
[WRAP TEXT] Applied wrap_text to 55268 cells, skipped 944 merged cells
[ROW HEIGHT] Set header heights: Row 1-2: 30.6, Row 3: 38.4
[EXCEL] Created RUH-CAI THREATS ALERT sheet
[EXCEL] Creating sheets for RUH-ATZ...
[LOAD FACTOR] Written 4 rows for RUH-ATZ
[EXCEL] Created RUH-ATZ LOAD FACTOR sheet
[FORMAT] Applying table formatting to LF sheet (LOAD FACTOR) 'RUH-ATZ LOAD FACTOR'...
[TABLE] Creating Excel Table 'Table_RUH_ATZ_LOAD_FACTOR' for sheet 'RUH-ATZ LOAD FACTOR' (max_row=5, max_col=36)...
[TABLE] Excel Table 'Table_RUH_ATZ_LOAD_FACTOR' created: 4 data rows (Total Row enabled)
[TABLE] Main LF table ends at row 5 (Outbound Connections table is separate)
[TABLE] totalsRowShown=True in openpyxl, Excel COM will update with correct formulas
[FORMAT] Applied number formats to 36 columns in sheet 'RUH-ATZ LOAD FACTOR'
[OAL] Built LF lookup with 4 flight entries
[OAL] Collected 595 rows for RUH-ATZ
[OAL] Created Table 'Table_RUH_ATZ_OAL'
[EXCEL] [OK] Created OAL sheet: 'RUH-ATZ OAL' with 595 flights
[EXCEL]    - LF Comments prepared for 4 Air Cairo rows
[EXCEL]    - Table name: Table_RUH_ATZ_OAL
[EXCEL] Created RUH-ATZ OAL sheet
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-28 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM464']...
[THREATS ALERT] Merging 'Indirect competition' row 8, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 55 Cairo rows starting at row 9
[THREATS ALERT-CAIRO] note_row=8, original_oal_last_row=7, data_start_row=6
[THREATS ALERT-CAIRO] Cairo row 0: Cell(9,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(9,2) [FLIGHT NUM] = 'F3-611'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(9,3) [DEPARTURE] = '18:15'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(9,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 15 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(9,5) [AVAILABILITY] = '79 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(9,6) [PUBLISHED FARE] = '259 SAR'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(10,1) [AIRLINE] = 'flyadeal'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(10,2) [FLIGHT NUM] = 'F3-611'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(10,3) [DEPARTURE] = '18:15'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(10,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 25 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(10,5) [AVAILABILITY] = '79 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(10,6) [PUBLISHED FARE] = '437 SAR'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 9 to 63
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-ATZ, date=2025-12-28, currency=SAR
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-30 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM464']...
[THREATS ALERT] Merging 'Indirect competition' row 69, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 55 Cairo rows starting at row 70
[THREATS ALERT-CAIRO] note_row=69, original_oal_last_row=68, data_start_row=67
[THREATS ALERT-CAIRO] Cairo row 0: Cell(70,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(70,2) [FLIGHT NUM] = 'E5-416'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(70,3) [DEPARTURE] = '05:40'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(70,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 30 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(70,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(70,6) [PUBLISHED FARE] = '298 SAR'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(71,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(71,2) [FLIGHT NUM] = 'E5-416'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(71,3) [DEPARTURE] = '05:40'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(71,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 2 x 40 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(71,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(71,6) [PUBLISHED FARE] = '504 SAR'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 70 to 124
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-ATZ, date=2025-12-30, currency=SAR
[THREATS ALERT-LF] Processing 1 LF rows for 2025-12-31 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM466']...
[THREATS ALERT] Merging 'Indirect competition' row 130, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 52 Cairo rows starting at row 131
[THREATS ALERT-CAIRO] note_row=130, original_oal_last_row=129, data_start_row=128
[THREATS ALERT-CAIRO] Cairo row 0: Cell(131,1) [AIRLINE] = 'Saudia'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(131,2) [FLIGHT NUM] = 'SV-6676'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(131,3) [DEPARTURE] = '12:00'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(131,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 2 x 46 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(131,5) [AVAILABILITY] = '4 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(131,6) [PUBLISHED FARE] = '1,366 SAR'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(132,1) [AIRLINE] = 'Saudia'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(132,2) [FLIGHT NUM] = 'SV-321'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(132,3) [DEPARTURE] = '20:05'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(132,4) [BAGGAGE] = 'Cabin: 7 KG / Check-in: 23 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(132,5) [AVAILABILITY] = '+9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(132,6) [PUBLISHED FARE] = '1,647 SAR'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 131 to 182
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-ATZ, date=2025-12-31, currency=SAR
[THREATS ALERT-LF] Processing 1 LF rows for 2026-01-04 (LF_SM_ONLY=True)
[THREATS ALERT-LF] Created LF map with 1 flights: ['SM464']...
[THREATS ALERT] Merging 'Indirect competition' row 188, columns A:F (1:6)
[THREATS ALERT-CAIRO] Writing 55 Cairo rows starting at row 189
[THREATS ALERT-CAIRO] note_row=188, original_oal_last_row=187, data_start_row=186
[THREATS ALERT-CAIRO] Cairo row 0: Cell(189,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(189,2) [FLIGHT NUM] = 'E5-416'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(189,3) [DEPARTURE] = '05:40'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(189,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 30 KG'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(189,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 0: Cell(189,6) [PUBLISHED FARE] = '304 SAR'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(190,1) [AIRLINE] = 'Air Arabia Egypt'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(190,2) [FLIGHT NUM] = 'E5-416'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(190,3) [DEPARTURE] = '05:40'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(190,4) [BAGGAGE] = 'Cabin: 10 KG / Check-in: 2 x 40 KG'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(190,5) [AVAILABILITY] = '9 FOR SAME CLASS'
[THREATS ALERT-CAIRO] Cairo row 1: Cell(190,6) [PUBLISHED FARE] = '509 SAR'
[THREATS ALERT-CAIRO] Finished writing Cairo rows 189 to 243
[THREAT-CONTEXT-DEBUG] Set context: route=RUH-ATZ, date=2026-01-04, currency=SAR
[MACRO1-EQUIV] Skipping THREATS ALERT sheet: RUH-ATZ THREATS ALERT (fonts set elsewhere)
[FORMAT] Applied number formats to 18 columns in sheet 'RUH-ATZ THREATS ALERT'
[WRAP TEXT] Applied wrap_text to 22031 cells, skipped 417 merged cells
[ROW HEIGHT] Set header heights: Row 1-2: 30.6, Row 3: 38.4
[EXCEL] Created RUH-ATZ THREATS ALERT sheet
10:37:24 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Applying formatting...
[MACRO1] Processing worksheet: RUH-CAI LOAD FACTOR
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 29 rows x 36 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] [OK] Applied CENTER alignment to 420 cells, skipped 8 merged cells in LF sheet
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Processing worksheet: RUH-CAI OAL
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 577 rows x 8 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] Formatted 4616 cells, skipped 0 merged cells
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Skipping THREATS ALERT sheet: RUH-CAI THREATS ALERT (alignment handled separately)
[MACRO1] Processing worksheet: RUH-ATZ LOAD FACTOR
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 5 rows x 36 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] [OK] Applied CENTER alignment to 180 cells, skipped 0 merged cells in LF sheet
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Processing worksheet: RUH-ATZ OAL
[MACRO1] Selecting all cells (equivalent to Cells.Select)
[MACRO1] Used range: 596 rows x 8 columns
[MACRO1] Applying cell formatting (equivalent to With Selection)
[MACRO1] Formatted 4768 cells, skipped 0 merged cells
[MACRO1] Macro1 formatting completed successfully
[MACRO1] Skipping THREATS ALERT sheet: RUH-ATZ THREATS ALERT (alignment handled separately)
10:37:25 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Saved to temp file: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\.tmp_ebsgb3za.xlsx
10:37:25 | INFO     | orchestration.queue_worker_system | [INCREMENTAL] Atomic write completed: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\KSA_TO_EGY_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
[AUTOFIT] Loading workbook: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\KSA_TO_EGY_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
[AUTOFIT]   Processing sheet: RUH-CAI LOAD FACTOR
[AUTOFIT]   Processing sheet: RUH-CAI OAL
[AUTOFIT]   Processing sheet: RUH-CAI THREATS ALERT
[AUTOFIT]     Excluding column: G (preserving width: 25.0)
[AUTOFIT]   Processing sheet: RUH-ATZ LOAD FACTOR
[AUTOFIT]   Processing sheet: RUH-ATZ OAL
[AUTOFIT]   Processing sheet: RUH-ATZ THREATS ALERT
[AUTOFIT]     Excluding column: G (preserving width: 25.0)
[AUTOFIT] Saving workbook...
[AUTOFIT] [OK] AutoFit completed successfully
10:37:27 | INFO     | core.shared_storage | [FILE] Marked RUH-CAI as written
10:37:27 | INFO     | core.shared_storage | [FILE] Marked RUH-ATZ as written
[SUCCESS] Consolidated file saved: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\KSA_TO_EGY_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
  Routes included: 2
  Sheets per route: THREATS ALERT, LOAD FACTOR, OAL

[FILE SAVED] KSA -> EGY -> D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\KSA_TO_EGY_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx
10:37:27 | INFO     | ExcelWriter | [WRITER] Written (2): KSA -> EGY -> D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\KSA_TO_EGY_26DEC25_TO_05JAN26_generated_at_25dec_10.37.xlsx

[OK] File generation complete:
  Mode: BY_DIRECTION
  Groups written: 2
  Output directory: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34

[STEP 10] Creating consolidated LOAD_FACTOR_SUMMARY file...
10:37:28 | INFO     | orchestration.queue_worker_system | [LF_SUMMARY] Creating consolidated LOAD_FACTOR_SUMMARY file...
10:37:28 | INFO     | orchestration.queue_worker_system | [LF_SUMMARY] Run 20251225_103430: consolidating 2 Excel files
  Scanning 2 Excel files for LF sheets (LOAD FACTOR)...
10:37:30 | INFO     | orchestration.queue_worker_system | [LF_SUMMARY] Collected 4 LOAD FACTOR sheets
  Found 4 LOAD FACTOR sheets
  Creating consolidated LF_ALL_ROUTES sheet...
[LF_ALL_ROUTES] Creating consolidated sheet from all LOAD FACTOR sheets...
[LF_ALL_ROUTES] Found 4 LOAD FACTOR sheets to consolidate
[LF_ALL_ROUTES DEBUG] LOAD FACTOR sheets found: ['CAI-RUH LOAD FACTOR', 'ATZ-RUH LOAD FACTOR', 'RUH-CAI LOAD FACTOR', 'RUH-ATZ LOAD FACTOR']
[LF_ALL_ROUTES] Detected 3 empty rows at row 17 in CAI-RUH LOAD FACTOR, stopping at row 14
[LF_ALL_ROUTES] Detected 3 empty rows at row 8 in ATZ-RUH LOAD FACTOR, stopping at row 5
[LF_ALL_ROUTES] Detected 3 empty rows at row 17 in RUH-CAI LOAD FACTOR, stopping at row 14
[LF_ALL_ROUTES] Sorted 34 total rows
[LF_ALL_ROUTES] Written 34 rows to consolidated sheet
[LF_SUMMARY FORMAT] Applying single formatting authority...
[LF_SUMMARY FORMAT] Created Excel Table with Total Row: 34 data rows
[LF_SUMMARY FORMAT] Applied number formats (%, dates, integers)
[LF_SUMMARY FORMAT] Applied center alignment to all cells
[LF_SUMMARY FORMAT] ✅ Formatting complete! Total Row at row 64
  [OK] Single formatting authority applied successfully
  Creating CANCELLED_FLIGHTS sheet (3 flights)...
  [OK] CANCELLED_FLIGHTS sheet created with 3 entries
10:37:30 | WARNING  | orchestration.queue_worker_system | Failed to format date range, using current date: 'str' object has no attribute 'strftime'
10:37:30 | INFO     | orchestration.queue_worker_system | [LF_SUMMARY] Saved: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\LOAD_FACTOR_SUMMARY_25-12-25_TO_25-DEC-25_generated_at_25dec_10.37.xlsx
[AUTOFIT] Loading workbook: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\LOAD_FACTOR_SUMMARY_25-12-25_TO_25-DEC-25_generated_at_25dec_10.37.xlsx
[AUTOFIT]   Processing sheet: LF_ALL_ROUTES
[AUTOFIT]   Processing sheet: CANCELLED_FLIGHTS
[AUTOFIT] Saving workbook...
[AUTOFIT] [OK] AutoFit completed successfully
[OK] LOAD_FACTOR_SUMMARY saved: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\LOAD_FACTOR_SUMMARY_25-12-25_TO_25-DEC-25_generated_at_25dec_10.37.xlsx

======================================================================
                    EXECUTION COMPLETED
======================================================================
  Total Time: 180.1s (3.0 minutes)
  Groups Completed: 12/12
  Output Directory: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34
======================================================================

[STEP 11] Running smart cleanup...

============================================================
               SMART CLEANUP
============================================================
[1/5] Cleaning Chrome temp directories...
      Cleaned: 0/0 dirs (0.0 MB freed)
[2/5] Chrome process cleanup: SKIPPED (disabled)
[3/5] Cleaning worker communication files...
      Cleaned: 0/2 files
[5/5] __pycache__ cleanup: SKIPPED (disabled)
============================================================
  Total space freed: 0.00 MB
============================================================


[INFO] All work completed. Stopping components...
10:37:33 | INFO     | managers.checkpoint_manager | Run marked as COMPLETED
10:37:33 | INFO     | orchestration.queue_worker_system | Result processor stopped
[THREAT-REPORT-DEBUG] Collector has 275 threats
[Mobile Report] Generated: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\reports\THREAT_ALERT_REPORT_MOBILE.html
10:37:33 | INFO     | reports.threat_alert_report.github_publisher | Updated index.html
10:37:33 | INFO     | reports.threat_alert_report.github_publisher | Updated mobile.html
10:37:33 | INFO     | reports.threat_alert_report.github_publisher | Archived mobile as report_2025_12_25_10-34_mobile.html
10:37:33 | INFO     | reports.threat_alert_report.github_publisher | Archived as report_2025_12_25_10-34.html
10:37:35 | INFO     | reports.threat_alert_report.github_publisher | Successfully published to GitHub Pages

============================================================
  THREAT ALERT REPORT PUBLISHED!
============================================================
  Desktop: https://gharieb-ai.github.io/AirCairo/
  Mobile:  https://gharieb-ai.github.io/AirCairo/mobile.html
  Archive: https://gharieb-ai.github.io/AirCairo/archive/report_2025_12_25_10-34.html
============================================================

10:37:35 | INFO     | ExcelWriter | [WRITER] THREAT_ALERT_REPORT saved: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34\reports\THREAT_ALERT_REPORT.html
[OK] THREAT_ALERT_REPORT.html generated
10:37:35 | INFO     | ExcelWriter | [WRITER] Excel Writer Process finished. Wrote 2 files.
10:37:35 | INFO     | orchestration.queue_worker_system | [OAL] Stopping processor...
10:37:35 | INFO     | orchestration.queue_worker_system | OALProcessor stopped (completed: True)

============================================================
           ✓ SAFE STOP - ALL WORK COMPLETED
============================================================
  Tasks Completed: 12/12
  Status: Run finished successfully
  Resume: Not needed
============================================================

[GEMINI] Model gemini-2.0-flash quota exceeded, trying next...
[GEMINI] Model gemini-1.5-flash quota exceeded, trying next...
[GEMINI] Model gemini-1.5-pro quota exceeded, trying next...
[GEMINI] Model gemini-pro quota exceeded, trying next...

[96m======================================================================[0m
[1m  Execution Complete[0m
[96m======================================================================[0m

  Success: [92mTrue[0m
  Completed: 12/12
  Elapsed: 180.1s
  Output: D:\CODERED\LAB\market_insights\outputs\run_generated_251225_at_10.34

