<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±ØµØ¯ Ø­Ø±ÙƒØ© Ø§Ù„Ø§Ø³Ø¹Ø§Ø± | Threat Alert Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Segoe UI', 'Cairo', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            transition: direction 0.3s ease;
        }

        body.en {
            direction: ltr;
        }

        body.ar {
            direction: rtl;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 45px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            font-weight: 700;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .header-info {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            font-size: 1.05em;
            opacity: 0.95;
            margin-top: 15px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .lang-btn {
            padding: 10px 25px;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .lang-btn:hover, .lang-btn.active {
            background: white;
            color: #667eea;
        }

        .route-select {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            min-width: 200px;
            background: white;
            color: #333;
        }

        .download-btn {
            padding: 10px 25px;
            border: none;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .download-btn:hover {
            background: linear-gradient(135deg, #219a52 0%, #27ae60 100%);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
            transform: translateY(-2px);
        }

        .download-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            box-shadow: none;
        }

        .pdf-btn {
            padding: 10px 25px;
            border: none;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .pdf-btn:hover {
            background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
            transform: translateY(-2px);
        }

        .content {
            padding: 35px;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-bottom: 35px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .stat-card.active-filter {
            border-color: white;
            box-shadow: 0 0 20px rgba(255,255,255,0.5);
            transform: scale(1.05);
        }

        .stat-card.high {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .stat-card.medium {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .stat-card.low {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }

        .stat-card h3 {
            font-size: 0.95em;
            opacity: 0.9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: 700;
        }

        .route-section {
            display: none;
        }

        .route-section.active {
            display: block;
        }

        .route-header {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-size: 1.4em;
            font-weight: 700;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 3px 10px rgba(155, 89, 182, 0.3);
        }

        body.ar .route-header {
            border-right: 5px solid #3498db;
        }

        body.en .route-header {
            border-left: 5px solid #3498db;
        }

        .date-section {
            margin-bottom: 35px;
        }

        .date-header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(44, 62, 80, 0.3);
        }

        .date-main {
            font-size: 1.2em;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .date-flights {
            font-size: 0.8em;
            font-weight: 400;
            opacity: 0.85;
        }

        body.ar .date-header {
            border-right: 6px solid #3498db;
        }

        body.en .date-header {
            border-left: 6px solid #3498db;
        }

        .flight-block {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 25px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .flight-header {
            background: linear-gradient(90deg, #ecf0f1 0%, #bdc3c7 100%);
            padding: 18px 20px;
            border-bottom: 2px solid #bdc3c7;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .flight-name {
            font-size: 1.15em;
            font-weight: 700;
            color: #2c3e50;
        }

        .flight-info {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .flight-route-date {
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .route-tag {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .date-tag {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 110px;
            text-align: center;
        }

        .status-low {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .status-medium {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffeaa7;
        }

        .status-high {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .competitors-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
        }

        .competitors-table thead {
            background: #3498db;
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .competitors-table th {
            padding: 14px;
            font-weight: 700;
            border: 1px solid #2980b9;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 0.5px;
        }

        body.ar .competitors-table th {
            text-align: right;
        }

        body.en .competitors-table th {
            text-align: left;
        }

        .competitors-table td {
            padding: 12px 14px;
            border: 1px solid #ecf0f1;
        }

        .competitors-table tbody tr:nth-child(odd) {
            background: #f9f9f9;
        }

        .competitors-table tbody tr:hover {
            background: #eef5ff;
            transition: background 0.2s ease;
        }

        .competitor-name {
            font-weight: 700;
            color: #2c3e50;
            min-width: 140px;
        }

        .fare-cell {
            text-align: center;
            font-weight: 600;
        }

        .fare-negative {
            color: #e74c3c;
            font-weight: 700;
            background: #ffebee;
            padding: 2px 6px;
            border-radius: 3px;
        }

        .fare-positive {
            color: #27ae60;
            font-weight: 700;
            background: #e8f5e9;
            padding: 2px 6px;
            border-radius: 3px;
        }

        .baggage-cell {
            text-align: center;
            font-weight: 500;
        }

        .baggage-negative {
            color: #e74c3c;
            background: #ffebee;
            padding: 2px 6px;
            border-radius: 3px;
        }

        .baggage-positive {
            color: #27ae60;
            background: #e8f5e9;
            padding: 2px 6px;
            border-radius: 3px;
        }

        .threat-indicator {
            text-align: center;
            font-weight: 700;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 0.85em;
            display: inline-block;
            min-width: 90px;
        }

        .threat-high {
            background: #f8d7da;
            color: #721c24;
        }

        .threat-medium {
            background: #fff3cd;
            color: #856404;
        }

        .threat-low {
            background: #d4edda;
            color: #155724;
        }

        /* Alternative route badge - indirect competition */
        .alt-badge {
            display: inline-block;
            background: #6c5ce7;
            color: white;
            font-size: 0.7em;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 3px;
            margin-left: 6px;
            vertical-align: middle;
            text-transform: uppercase;
        }

        tr[data-is-alternative="true"] {
            background: rgba(108, 92, 231, 0.05);
        }

        tr[data-is-alternative="true"]:hover {
            background: rgba(108, 92, 231, 0.1);
        }

        .summary-section {
            background: #f5f6fa;
            padding: 35px;
            border-top: 3px solid #e0e0e0;
            margin-top: 40px;
        }

        .summary-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 25px;
            border-bottom: 4px solid #3498db;
            padding-bottom: 12px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 40px;
        }

        .summary-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        body.ar .summary-card {
            border-right: 5px solid #3498db;
        }

        body.en .summary-card {
            border-left: 5px solid #3498db;
        }

        .summary-card.high {
            border-color: #e74c3c;
        }

        .summary-card.medium {
            border-color: #f39c12;
        }

        .summary-card.low {
            border-color: #27ae60;
        }

        .summary-value {
            font-size: 2.2em;
            font-weight: 700;
            color: #2c3e50;
            margin: 12px 0;
        }

        .summary-label {
            font-size: 0.9em;
            color: #7f8c8d;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .footer {
            background: #2c3e50;
            color: white;
            padding: 25px 30px;
            text-align: center;
            font-size: 0.9em;
            opacity: 0.85;
        }

        .print-btn {
            position: fixed;
            bottom: 20px;
            padding: 12px 24px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
            z-index: 100;
            transition: all 0.3s ease;
        }

        body.ar .print-btn {
            left: 20px;
        }

        body.en .print-btn {
            right: 20px;
        }

        .print-btn:hover {
            background: #2980b9;
            box-shadow: 0 6px 16px rgba(52, 152, 219, 0.6);
            transform: translateY(-2px);
        }

        /* Scrolling Ticker/Marquee */
        .ticker-wrapper {
            background: linear-gradient(90deg, #1a1a2e 0%, #16213e 50%, #1a1a2e 100%);
            overflow: hidden;
            white-space: nowrap;
            padding: 12px 0;
            position: relative;
            border-bottom: 2px solid #F7941D;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .ticker-content {
            display: inline-block;
            animation: ticker 20s linear infinite;
            padding-left: 100%;
            color: #ecf0f1;
            font-weight: 600;
            font-size: 0.95em;
        }

        .ticker-content span {
            padding: 0 50px;
        }

        .ticker-highlight {
            color: #f39c12;
            font-weight: 700;
        }

        
        .ticker-generated {
            background: linear-gradient(135deg, #F7941D 0%, #ff6b00 100%);
            color: #fff !important;
            padding: 4px 12px !important;
            border-radius: 15px;
            font-weight: 700;
            animation: pulse-glow 2s ease-in-out infinite;
            margin: 0 10px;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 5px rgba(247, 148, 29, 0.5); }
            50% { box-shadow: 0 0 15px rgba(247, 148, 29, 0.8); }
        }

        .ticker-high {
            color: #ff4757 !important;
            font-weight: 700;
            font-size: 1.1em;
        }

        .ticker-medium {
            color: #ffa502 !important;
            font-weight: 700;
            font-size: 1.1em;
        }

        .ticker-low {
            color: #ffd32a !important;
            font-weight: 700;
            font-size: 1.1em;
        }

        .ticker-total {
            color: #fff !important;
            font-weight: 700;
            font-size: 1.15em;
            background: rgba(255,255,255,0.1);
            padding: 2px 8px;
            border-radius: 8px;
        }

        .ticker-separator {
            color: #F7941D;
            font-weight: 300;
        }

        @keyframes ticker {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-100%);
            }
        }

        .ticker-wrapper:hover .ticker-content {
            animation-play-state: paused;
        }

        /* Load Factor Badge */
        .load-factor-badge {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9em;
            display: inline-flex;
            align-items: center;
            gap: 40px;
        }

        .load-factor-value {
            background: rgba(255,255,255,0.2);
            padding: 3px 10px;
            border-radius: 12px;
        }

        /* LF Details Bar - displays full Load Factor information */
        .lf-details-bar {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 8px;
            padding: 12px 15px;
            margin: 10px 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 40px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .lf-detail-item {
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            padding: 6px 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
            transition: transform 0.2s ease, background 0.2s ease;
        }

        .lf-detail-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .lf-detail-label {
            color: #95a5a6;
            font-size: 0.7em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 3px;
        }

        .lf-detail-value {
            color: #ecf0f1;
            font-size: 1em;
            font-weight: 700;
        }

        .lf-detail-item.highlight {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }

        .lf-detail-item.highlight .lf-detail-label {
            color: #ffffff;
        }

        .lf-detail-item.highlight .lf-detail-value {
            color: white;
        }

        .lf-detail-item.warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .lf-detail-item.warning .lf-detail-label {
            color: #ffffff;
        }

        .lf-detail-item.warning .lf-detail-value {
            color: white;
        }

        .lf-detail-item.danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .lf-detail-item.danger .lf-detail-label {
            color: #ffffff;
        }

        .lf-detail-item.danger .lf-detail-value {
            color: white;
        }

        /* Hide language-specific content */
        .ar-text {
            display: none;
        }

        .en-text {
            display: none;
        }

        body.ar .ar-text {
            display: inline;
        }

        body.en .en-text {
            display: inline;
        }

        @media print {
            body {
                background: white !important;
                padding: 0 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .container {
                box-shadow: none !important;
                border-radius: 0 !important;
                max-width: 100% !important;
            }
            .print-btn, .controls, .pdf-btn, .download-btn, .lang-btn, .route-select, .ticker-wrapper {
                display: none !important;
            }
            .header {
                padding: 25px 20px !important;
            }
            .header h1 {
                font-size: 2em !important;
            }
            .quick-stats {
                page-break-inside: avoid;
                display: grid !important;
                grid-template-columns: repeat(3, 1fr) !important;
            }
            .stat-card {
                padding: 15px !important;
            }
            .stat-card .number {
                font-size: 1.8em !important;
            }
            .flight-block {
                page-break-inside: avoid;
                margin-bottom: 15px !important;
            }
            .route-section {
                display: block !important;
                page-break-before: auto;
            }
            .route-section:not(.active) {
                display: none !important;
            }
            .date-section {
                page-break-inside: avoid;
            }
            .date-section[style*="display: none"] {
                display: none !important;
            }
            .summary-section {
                page-break-before: always;
            }
            .competitors-table {
                font-size: 0.85em !important;
            }
            .competitors-table th,
            .competitors-table td {
                padding: 8px !important;
            }
            .threat-high, .threat-medium, .threat-low,
            .fare-negative, .fare-positive,
            .baggage-negative, .baggage-positive {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5em;
            }

            .header {
                padding: 25px 15px;
            }

            .controls {
                flex-direction: column;
                gap: 40px;
            }

            .lang-btn, .route-select, .download-btn, .pdf-btn {
                width: 100%;
                text-align: center;
            }

            .content {
                padding: 15px;
            }

            .quick-stats {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .stat-card {
                padding: 15px;
            }

            .stat-card .number {
                font-size: 2em;
            }

            .route-header {
                font-size: 1.2em !important;
                padding: 15px;
            }

            .date-header {
                font-size: 1em !important;
                padding: 12px;
            }

            .flight-block {
                margin-bottom: 15px;
                border-radius: 6px;
            }

            .flight-header {
                flex-direction: column;
                align-items: flex-start;
                padding: 12px;
            }

            /* IMPORTANT: Enable horizontal scroll for table on mobile */
            .flight-block {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .competitors-table {
                font-size: 0.75em;
                min-width: 700px;
            }

            .competitors-table th,
            .competitors-table td {
                padding: 6px 8px;
                white-space: nowrap;
            }

            .competitor-name {
                min-width: 100px;
            }

            .threat-indicator {
                min-width: 70px;
                font-size: 0.75em;
                padding: 4px 6px;
            }

            /* LF Details Bar mobile */
            .lf-details-bar {
                padding: 10px;
                margin: 8px 10px;
                gap: 6px;
            }

            .lf-detail-item {
                padding: 4px 8px;
                min-width: 55px;
            }

            .lf-detail-label {
                font-size: 0.6em;
            }

            .lf-detail-value {
                font-size: 0.85em;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .summary-card {
                padding: 15px;
            }

            .summary-value {
                font-size: 1.8em;
            }

            .print-btn {
                position: static;
                margin-top: 20px;
                display: block;
                width: 100%;
            }

            .footer {
                padding: 15px;
                font-size: 0.8em;
            }
        }

        /* Extra small screens (phones in portrait) */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.3em;
            }

            .competitors-table {
                font-size: 0.7em;
            }

            .stat-card h3 {
                font-size: 0.8em;
            }
        }
    
        /* Threat Level Color Overlay */
        .threat-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .threat-overlay.active {
            opacity: 1;
        }
        .threat-overlay.high {
            background: radial-gradient(ellipse at center, rgba(220, 53, 69, 0.15) 0%, rgba(220, 53, 69, 0.05) 70%, transparent 100%);
        }
        .threat-overlay.medium {
            background: radial-gradient(ellipse at center, rgba(255, 193, 7, 0.15) 0%, rgba(255, 193, 7, 0.05) 70%, transparent 100%);
        }
        .threat-overlay.low {
            background: radial-gradient(ellipse at center, rgba(40, 167, 69, 0.15) 0%, rgba(40, 167, 69, 0.05) 70%, transparent 100%);
        }

    </style>
</head>
<body class="ar">
    <div id="threatOverlay" class="threat-overlay"></div>
    <button class="print-btn" onclick="window.print()">
        <span class="ar-text">Ø·Ø¨Ø§Ø¹Ø©</span>
        <span class="en-text">Print</span>
    </button>

    <!-- Scrolling Ticker -->
    <div class="ticker-wrapper">
        <div class="ticker-content">
            <span class="ar-text">
                ğŸ“Š Ø±ØµØ¯ Ø­Ø±ÙƒØ© Ø§Ù„Ø§Ø³Ø¹Ø§Ø± |
                <span class="ticker-generated">ğŸ• ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: 25DEC25 01:29 AM</span> |
                Ø§Ù„ÙØªØ±Ø©: <span class="ar-text">Ø§Ù„ØªØ§Ø±ÙŠØ®: 25DEC25</span><span class="en-text">Date: 25DEC25</span> |
                Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª: <span class="ticker-highlight" id="ticker-total">1</span> |
                ğŸ”´ Ø¹Ø§Ù„ÙŠ: <span class="ticker-high" id="ticker-high">1</span> |
                ğŸŸ  Ù…ØªÙˆØ³Ø·: <span class="ticker-medium" id="ticker-medium">0</span> |
                ğŸŸ¡ Ù…Ù†Ø®ÙØ¶: <span class="ticker-low" id="ticker-low">0</span>
            </span>
            <span class="en-text">
                ğŸ“Š Threat Alert Report |
                <span class="ticker-generated">ğŸ• Generated: 25DEC25 01:29 AM</span> |
                Range: <span class="ar-text">Ø§Ù„ØªØ§Ø±ÙŠØ®: 25DEC25</span><span class="en-text">Date: 25DEC25</span> |
                Total Threats: <span class="ticker-highlight" id="ticker-total-en">1</span> |
                ğŸ”´ HIGH: <span class="ticker-high" id="ticker-high-en">1</span> |
                ğŸŸ  MEDIUM: <span class="ticker-medium" id="ticker-medium-en">0</span> |
                ğŸŸ¡ LOW: <span class="ticker-low" id="ticker-low-en">0</span>
            </span>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>
                    <span class="ar-text">Ø±ØµØ¯ Ø­Ø±ÙƒØ© Ø§Ù„Ø§Ø³Ø¹Ø§Ø±</span>
                    <span class="en-text">Threat Alert Report</span>
                </h1>
                <div class="header-info">
                    <span><span class="ar-text">Ø§Ù„ØªØ§Ø±ÙŠØ®: 25DEC25</span><span class="en-text">Date: 25DEC25</span></span>
                </div>
                <div class="controls">
                    <button class="lang-btn active" id="btn-ar" onclick="setLanguage('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
                    <button class="lang-btn" id="btn-en" onclick="setLanguage('en')">English</button>
                    <select class="route-select" id="route-select" onchange="showRoute(this.value)">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø®Ø·ÙˆØ· Ø§Ù„Ø³ÙŠØ±</option>
                        <option value="JED-CAI">JED-CAI</option>
                    </select>
                    <select class="route-select" id="date-select" onchange="showDate(this.value)">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</option>
                        <option value="2025-12-25">25 DECEMBER 2025 THURSDAY</option>
                    </select>
                    <button class="download-btn" id="download-btn" onclick="downloadRouteExcel()">
                        <span class="ar-text">ØªÙ†Ø²ÙŠÙ„ Excel</span>
                        <span class="en-text">Download Excel</span>
                    </button>
                    <button class="pdf-btn" onclick="downloadPDF()">
                        <span class="ar-text">ØªØ­Ù…ÙŠÙ„ PDF</span>
                        <span class="en-text">Download PDF</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="content">
            <div class="quick-stats" id="stats-container">
                <div class="stat-card high" onclick="filterByThreatLevel('high')" title="Click to filter HIGH threats">
                    <h3>
                        <span class="ar-text">Ø¹Ø§Ù„ÙŠ - ÙŠØªØ·Ù„Ø¨ Ø§Ø¬Ø±Ø§Ø¡</span>
                        <span class="en-text">HIGH - NEED ACTION</span>
                    </h3>
                    <div class="number" id="stat-high">1</div>
                    <div style="font-size: 0.7em; opacity: 0.8; margin-top: 5px;">
                        <span class="ar-text">Ø§Ø¶ØºØ· Ù„Ù„ÙÙ„ØªØ±</span>
                        <span class="en-text">Click to filter</span>
                    </div>
                </div>
                <div class="stat-card medium" onclick="filterByThreatLevel('medium')" title="Click to filter MEDIUM threats">
                    <h3>
                        <span class="ar-text">Ù…ØªÙˆØ³Ø·</span>
                        <span class="en-text">MEDIUM</span>
                    </h3>
                    <div class="number" id="stat-medium">0</div>
                    <div style="font-size: 0.7em; opacity: 0.8; margin-top: 5px;">
                        <span class="ar-text">Ø§Ø¶ØºØ· Ù„Ù„ÙÙ„ØªØ±</span>
                        <span class="en-text">Click to filter</span>
                    </div>
                </div>
                <div class="stat-card low" onclick="filterByThreatLevel('low')" title="Click to filter LOW threats">
                    <h3>
                        <span class="ar-text">Ù…Ù†Ø®ÙØ¶</span>
                        <span class="en-text">LOW</span>
                    </h3>
                    <div class="number" id="stat-low">0</div>
                    <div style="font-size: 0.7em; opacity: 0.8; margin-top: 5px;">
                        <span class="ar-text">Ø§Ø¶ØºØ· Ù„Ù„ÙÙ„ØªØ±</span>
                        <span class="en-text">Click to filter</span>
                    </div>
                </div>
            </div>

            
        <div class="route-section" data-route="JED-CAI">
            <div class="route-header">
                <span class="ar-text">Ø®Ø· Ø§Ù„Ø³ÙŠØ±: JED-CAI</span>
                <span class="en-text">Route: JED-CAI</span>
            </div>
            
        <div class="date-section" data-date="2025-12-25">
            <div class="date-header">
                <div class="date-main">25 DECEMBER 2025 THURSDAY</div>
                <div class="date-flights">
                    <span class="ar-text">Ø§Ù„Ø±Ø­Ù„Ø§Øª: SM478</span>
                    <span class="en-text">Flights: SM478</span>
                </div>
            </div>
            
        <div class="flight-block" data-flight="SM478">
            <div class="flight-header">
                <div class="flight-info">
                    <span class="flight-name">
                        <span class="ar-text">Ø§Ù„Ø±Ø­Ù„Ø©: SM478</span>
                        <span class="en-text">Flight: SM478</span>
                    </span>
                    
            <div class="flight-route-date">
                <span class="route-tag">JED-CAI</span>
                <span class="date-tag">25DEC25</span>
            </div>
            
                </div>
                <span class="load-factor-badge" style="background: linear-gradient(135deg, #f39c12 0%, #f39c12dd 100%);">
                    <span class="ar-text">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø´ØºØ§Ù„:</span>
                    <span class="en-text">Load Factor:</span>
                    <span class="load-factor-value" data-flight-lf="SM478">75%</span>
                </span>
            </div>
            
        <div class="lf-details-bar">
            
                <div class="lf-detail-item ">
                    <span class="lf-detail-label">SOLD</span>
                    <span class="lf-detail-value">120</span>
                </div>
            
                <div class="lf-detail-item">
                    <span class="lf-detail-label">CAPACITY</span>
                    <span class="lf-detail-value">160</span>
                </div>
            
        </div>
        
            <table class="competitors-table">
                <thead>
    <tr>
        <th><span class="ar-text">Ø´Ø±ÙƒØ© Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©</span><span class="en-text">Market Threat Airline</span></th>
        <th><span class="ar-text">Ø³Ø¹Ø± Ø§Ù„Ù…Ù†Ø§ÙØ³</span><span class="en-text">OAL Fare Threat</span></th>
        <th><span class="ar-text">Ø³Ø¹Ø±Ù†Ø§</span><span class="en-text">Our Fare</span></th>
        <th><span class="ar-text">ÙØ±Ù‚ Ø§Ù„Ø³Ø¹Ø±</span><span class="en-text">Fare Dif</span></th>
        <th><span class="ar-text">Ø­Ù‚Ø§Ø¦Ø¨ Ø§Ù„Ù…Ù†Ø§ÙØ³</span><span class="en-text">OAL Baggage</span></th>
        <th><span class="ar-text">Ø­Ù‚Ø§Ø¦Ø¨Ù†Ø§</span><span class="en-text">Our Baggage</span></th>
        <th><span class="ar-text">ÙØ±Ù‚ Ø§Ù„ÙˆØ²Ù†</span><span class="en-text">Bag Allowance Dif</span></th>
        <th><span class="ar-text">Ø§Ù„ØªØ£Ø«ÙŠØ±</span><span class="en-text">IMPACT</span></th>
    </tr>
</thead>
                <tbody>
                    
        <tr data-threat-level="high" data-is-alternative="false">
            <td class="competitor-name">Saudia SV335 </td>
            <td class="fare-cell"><span class="ar-text">1250 Ø±ÙŠØ§Ù„</span><span class="en-text">1250 SAR</span></td>
            <td class="fare-cell"><span class="ar-text">1200 Ø±ÙŠØ§Ù„</span><span class="en-text">1200 SAR</span></td>
            <td class="fare-cell"><span class="fare-positive"><span class="ar-text">+50 Ø±ÙŠØ§Ù„</span><span class="en-text">+50 SAR</span></span></td>
            <td class="baggage-cell">46 kg</td>
            <td class="baggage-cell">40 kg</td>
            <td class="baggage-cell baggage-negative">-6 kg</td>
            <td style="text-align:center">
                <span class="threat-indicator threat-high">
                    <span class="ar-text">Ø¹Ø§Ù„ÙŠ - ÙŠØªØ·Ù„Ø¨ Ø§Ø¬Ø±Ø§Ø¡</span>
                    <span class="en-text">HIGH - NEED ACTION</span>
                </span>
            </td>
        </tr>
        
                </tbody>
            </table>
        </div>
        
        </div>
        
        </div>
        

        </div>

        <div class="summary-section">
            <h2 class="summary-title">
                <span class="ar-text">Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</span>
                <span class="en-text">Report Summary</span>
            </h2>
            <div class="summary-grid">
                <div class="summary-card high">
                    <div class="summary-label">
                        <span class="ar-text">ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø¹Ø§Ù„ÙŠØ© - ÙŠØªØ·Ù„Ø¨ Ø§Ø¬Ø±Ø§Ø¡</span>
                        <span class="en-text">HIGH - NEED ACTION</span>
                    </div>
                    <div class="summary-value" id="summary-high">1</div>
                </div>
                <div class="summary-card medium">
                    <div class="summary-label">
                        <span class="ar-text">ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ù…ØªÙˆØ³Ø·Ø©</span>
                        <span class="en-text">MEDIUM</span>
                    </div>
                    <div class="summary-value" id="summary-medium">0</div>
                </div>
                <div class="summary-card low">
                    <div class="summary-label">
                        <span class="ar-text">ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ù…Ù†Ø®ÙØ¶Ø©</span>
                        <span class="en-text">LOW</span>
                    </div>
                    <div class="summary-value" id="summary-low">0</div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>
                <span class="ar-text">Ø±ØµØ¯ Ø­Ø±ÙƒØ© Ø§Ù„Ø§Ø³Ø¹Ø§Ø± | <span class="ar-text">Ø§Ù„ØªØ§Ø±ÙŠØ®: 25DEC25</span><span class="en-text">Date: 25DEC25</span></span>
                <span class="en-text">Threat Alert Report | <span class="ar-text">Ø§Ù„ØªØ§Ø±ÙŠØ®: 25DEC25</span><span class="en-text">Date: 25DEC25</span></span>
            </p>
        </div>
    </div>

    <script>
    // Threat Level Color Overlay
    function setThreatOverlay(level) {
        let overlay = document.getElementById('threatOverlay');
        if (!overlay) {
            overlay = document.createElement('div');
            overlay.id = 'threatOverlay';
            overlay.className = 'threat-overlay';
            document.body.insertBefore(overlay, document.body.firstChild);
        }
        overlay.className = 'threat-overlay';
        if (level && level !== 'all') {
            overlay.classList.add(level.toLowerCase());
            overlay.classList.add('active');
        }
    }

        // Route statistics data (precomputed for route-only filtering)
        const routeStats = {"JED-CAI": {"high": 1, "medium": 0, "low": 0}, "_total": {"high": 1, "medium": 0, "low": 0}};

        // Detailed stats: route -> date -> {high, medium, low}
        const detailedStats = {"JED-CAI": {"2025-12-25": {"high": 1, "medium": 0, "low": 0}}};

        function setLanguage(lang) {
            document.body.className = lang;
            document.getElementById('btn-ar').classList.toggle('active', lang === 'ar');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');

            // Update route select options text
            updateRouteSelectText(lang);
        }

        function updateRouteSelectText(lang) {
            const routeSelect = document.getElementById('route-select');
            const dateSelect = document.getElementById('date-select');
            if (lang === 'ar') {
                routeSelect.options[0].text = 'Ø¬Ù…ÙŠØ¹ Ø®Ø·ÙˆØ· Ø§Ù„Ø³ÙŠØ±';
                dateSelect.options[0].text = 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®';
            } else {
                routeSelect.options[0].text = 'All Routes';
                dateSelect.options[0].text = 'All Dates';
            }
        }

        function showRoute(routeId) {
            const allSections = document.querySelectorAll('.route-section');

            if (routeId === 'all') {
                // Show all routes
                allSections.forEach(section => {
                    section.classList.add('active');
                });
            } else {
                // Hide all, show selected
                allSections.forEach(section => {
                    if (section.dataset.route === routeId) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });
            }

            // Reset date filter when route changes
            document.getElementById('date-select').value = 'all';
            const allDateSections = document.querySelectorAll('.date-section');
            allDateSections.forEach(section => {
                section.style.display = 'block';
            });

            // Update stats based on current selection
            updateStatsForSelection();
        }

        // Date filtering function
        function showDate(dateId) {
            const allDateSections = document.querySelectorAll('.date-section');

            if (dateId === 'all') {
                // Show all dates
                allDateSections.forEach(section => {
                    section.style.display = 'block';
                });
            } else {
                // Hide all, show selected
                allDateSections.forEach(section => {
                    if (section.dataset.date === dateId) {
                        section.style.display = 'block';
                    } else {
                        section.style.display = 'none';
                    }
                });
            }

            // Update stats based on current selection
            updateStatsForSelection();
        }

        // Calculate and update stats based on current route AND date selection
        function updateStatsForSelection() {
            const routeId = document.getElementById('route-select').value;
            const dateId = document.getElementById('date-select').value;

            let stats = { high: 0, medium: 0, low: 0 };

            if (routeId === 'all' && dateId === 'all') {
                // All routes, all dates - use precomputed total
                stats = routeStats['_total'];
            } else if (routeId !== 'all' && dateId === 'all') {
                // Specific route, all dates
                stats = routeStats[routeId] || { high: 0, medium: 0, low: 0 };
            } else if (routeId === 'all' && dateId !== 'all') {
                // All routes, specific date - sum across routes for this date
                for (const route in detailedStats) {
                    if (detailedStats[route][dateId]) {
                        stats.high += detailedStats[route][dateId].high || 0;
                        stats.medium += detailedStats[route][dateId].medium || 0;
                        stats.low += detailedStats[route][dateId].low || 0;
                    }
                }
            } else {
                // Specific route, specific date
                if (detailedStats[routeId] && detailedStats[routeId][dateId]) {
                    stats = detailedStats[routeId][dateId];
                }
            }

            // Update all stat displays
            updateAllStats(stats);
        }

        // Update all stat displays (cards, summary, ticker)
        function updateAllStats(stats) {
            const total = stats.high + stats.medium + stats.low;

            // Update stat cards
            document.getElementById('stat-high').textContent = stats.high;
            document.getElementById('stat-medium').textContent = stats.medium;
            document.getElementById('stat-low').textContent = stats.low;

            // Update summary section
            document.getElementById('summary-high').textContent = stats.high;
            document.getElementById('summary-medium').textContent = stats.medium;
            document.getElementById('summary-low').textContent = stats.low;

            // Update ticker (both Arabic and English)
            const tickerTotal = document.getElementById('ticker-total');
            const tickerHigh = document.getElementById('ticker-high');
            const tickerMedium = document.getElementById('ticker-medium');
            const tickerLow = document.getElementById('ticker-low');

            if (tickerTotal) tickerTotal.textContent = total;
            if (tickerHigh) tickerHigh.textContent = stats.high;
            if (tickerMedium) tickerMedium.textContent = stats.medium;
            if (tickerLow) tickerLow.textContent = stats.low;

            const tickerTotalEn = document.getElementById('ticker-total-en');
            const tickerHighEn = document.getElementById('ticker-high-en');
            const tickerMediumEn = document.getElementById('ticker-medium-en');
            const tickerLowEn = document.getElementById('ticker-low-en');

            if (tickerTotalEn) tickerTotalEn.textContent = total;
            if (tickerHighEn) tickerHighEn.textContent = stats.high;
            if (tickerMediumEn) tickerMediumEn.textContent = stats.medium;
            if (tickerLowEn) tickerLowEn.textContent = stats.low;
        }

        // Initialize: show all routes
        document.addEventListener('DOMContentLoaded', function() {
            showRoute('all');
            updateDownloadButton();
        });

        // Excel files mapping (populated by report builder)
        const routeExcelFiles = {"JED-CAI": "excel_routes/route_JED_CAI_threats.xlsx"};

        function updateDownloadButton() {
            const routeSelect = document.getElementById('route-select');
            const downloadBtn = document.getElementById('download-btn');
            const selectedRoute = routeSelect.value;

            if (selectedRoute === 'all') {
                downloadBtn.disabled = true;
                downloadBtn.title = document.body.className === 'ar'
                    ? 'Ø§Ø®ØªØ± Ø®Ø· Ø³ÙŠØ± Ù…Ø­Ø¯Ø¯ Ù„Ù„ØªÙ†Ø²ÙŠÙ„'
                    : 'Select a specific route to download';
            } else {
                downloadBtn.disabled = false;
                downloadBtn.title = '';
            }
        }

        // Override showRoute to update download button
        const originalShowRoute = showRoute;
        showRoute = function(routeId) {
            originalShowRoute(routeId);
            updateDownloadButton();
        };

        function downloadRouteExcel() {
            const routeSelect = document.getElementById('route-select');
            const selectedRoute = routeSelect.value;

            if (selectedRoute === 'all') {
                const msg = document.body.className === 'ar'
                    ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø®Ø· Ø³ÙŠØ± Ù…Ø­Ø¯Ø¯ Ù„Ù„ØªÙ†Ø²ÙŠÙ„'
                    : 'Please select a specific route to download';
                alert(msg);
                return;
            }

            // Check if Excel file exists for this route
            const excelFile = routeExcelFiles[selectedRoute];
            if (excelFile) {
                // Create download link
                const link = document.createElement('a');
                link.href = excelFile;
                link.download = excelFile.split('/').pop();
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                const msg = document.body.className === 'ar'
                    ? 'Ù…Ù„Ù Excel ØºÙŠØ± Ù…ØªÙˆÙØ± Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø±. ÙŠØ±Ø¬Ù‰ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ù…Ù„ Ø£ÙˆÙ„Ø§Ù‹.'
                    : 'Excel file not available for this route. Please run the full report first.';
                alert(msg);
            }
        }

        // PDF Download function
        function downloadPDF() {
            const isArabic = document.body.className === 'ar';

            // Show instructions
            const msg = isArabic
                ? 'Ø³ÙŠØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©.\n\nÙ„Ù„Ø­ÙØ¸ ÙƒÙ€ PDF:\n1. Ø§Ø®ØªØ± "Save as PDF" Ø£Ùˆ "Microsoft Print to PDF"\n2. Ø§Ø¶ØºØ· Save/Ø­ÙØ¸\n\nÙ…Ù„Ø§Ø­Ø¸Ø©: Ø³ÙŠØªÙ… Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø®Ø·/Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·.'
                : 'Print dialog will open.\n\nTo save as PDF:\n1. Select "Save as PDF" or "Microsoft Print to PDF"\n2. Click Save\n\nNote: Only the currently selected route/date will be printed.';

            alert(msg);

            // Trigger print
            window.print();
        }

        // Current threat level filter (null = show all)
        let currentThreatFilter = null;

        // Filter by threat level (clicking on stat cards)
        function filterByThreatLevel(level) {
            // Update visual overlay
            if (currentThreatFilter === level) {
                setThreatOverlay(null);
            } else {
                setThreatOverlay(level);
            }
            const statCards = document.querySelectorAll('.stat-card');
            const allRows = document.querySelectorAll('tr[data-threat-level]');

            // If clicking same filter, toggle off
            if (currentThreatFilter === level) {
                currentThreatFilter = null;
                // Remove active class from all cards
                statCards.forEach(card => card.classList.remove('active-filter'));
                // Show all rows
                allRows.forEach(row => {
                    row.style.display = '';
                });
                return;
            }

            // Set new filter
            currentThreatFilter = level;

            // Update card styles
            statCards.forEach(card => {
                if (card.classList.contains(level)) {
                    card.classList.add('active-filter');
                } else {
                    card.classList.remove('active-filter');
                }
            });

            // Filter rows by threat level
            allRows.forEach(row => {
                if (row.dataset.threatLevel === level) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Clear threat filter when route/date changes
        function clearThreatFilter() {
            currentThreatFilter = null;
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach(card => card.classList.remove('active-filter'));
            const allRows = document.querySelectorAll('tr[data-threat-level]');
            allRows.forEach(row => {
                row.style.display = '';
            });
        }

        // Update showRoute and showDate to clear threat filter
        const originalShowRoute2 = showRoute;
        showRoute = function(routeId) {
            clearThreatFilter();
            originalShowRoute2(routeId);
        };

        const originalShowDate = showDate;
        showDate = function(dateId) {
            clearThreatFilter();
            originalShowDate(dateId);
        };
    </script>
</body>
</html>
